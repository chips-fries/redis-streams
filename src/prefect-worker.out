08:28:06.528 | DEBUG   | prefect.profiles - Using profile 'uat'
08:28:07.371 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:07.394 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:07.414 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
Discovered type 'process' for work pool 'default'.
08:28:07.432 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Entering worker context...
08:28:07.432 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Setting up worker...
08:28:07.437 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:07.453 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:28:07.460 | DEBUG   | prefect.runner - Starting runner...
08:28:07.468 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:07.474 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
Worker 'ProcessWorker 853e55ce-760a-4c45-884f-563721ceeb78' started!
08:28:07.476 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:28:07.477 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:28:17.477156+00:00
08:28:07.477 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:28:07.483 | DEBUG   | prefect.events.clients - Reconnecting websocket connection.
08:28:07.483 | DEBUG   | prefect.events.clients - Opening websocket connection.
08:28:07.491 | DEBUG   | prefect.events.clients - Pinging to ensure websocket connected.
08:28:07.491 | DEBUG   | prefect.events.clients - Pong received. Websocket connected.
08:28:07.491 | DEBUG   | prefect.events.clients - Resending 0 unconfirmed events.
08:28:07.492 | DEBUG   | prefect.events.clients - Finished resending unconfirmed events.
08:28:07.492 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:07.492 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=ca63d070-2a60-4b8c-8e60-a52bf8371c2c.
08:28:07.492 | DEBUG   | prefect.events.clients - Added event id=ca63d070-2a60-4b8c-8e60-a52bf8371c2c to unconfirmed events list. There are now 1 unconfirmed events.
08:28:07.493 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:28:07.493 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=ca63d070-2a60-4b8c-8e60-a52bf8371c2c.
08:28:07.493 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=ca63d070-2a60-4b8c-8e60-a52bf8371c2c.
08:28:07.500 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 1 scheduled_flow_runs
08:28:07.501 | INFO    | prefect.flow_runs.worker - Worker 'ProcessWorker 853e55ce-760a-4c45-884f-563721ceeb78' submitting flow run 'a80a9968-4f21-4706-8b76-75b73713fb25'
08:28:07.502 | DEBUG   | prefect.client - Received response with retryable status code 503. Another attempt will be made in 1.7167342694396355s. This is attempt 1/6.
08:28:07.508 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:07.633 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Ready to submit a80a9968-4f21-4706-8b76-75b73713fb25: True
08:28:07.651 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=0e040d52-0ad8-4efc-b7fa-66233f64adf5.
08:28:07.652 | DEBUG   | prefect.events.clients - Added event id=0e040d52-0ad8-4efc-b7fa-66233f64adf5 to unconfirmed events list. There are now 2 unconfirmed events.
08:28:07.652 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:28:07.652 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=0e040d52-0ad8-4efc-b7fa-66233f64adf5.
08:28:07.653 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=0e040d52-0ad8-4efc-b7fa-66233f64adf5.
08:28:07.675 | INFO    | prefect.flow_runs.runner - Opening process...
08:28:07.692 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x104e4cd30>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106ec9420>>)
08:28:07.692 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:28:07.708 | INFO    | prefect.flow_runs.worker - Completed submission of flow run 'a80a9968-4f21-4706-8b76-75b73713fb25'
08:28:08.488 | DEBUG   | prefect.profiles - Using profile 'uat'
08:28:08.611 | DEBUG   | Flow run 'roaring-koel' - Running 1 deployment pull step(s)
08:28:08.618 | INFO    | Flow run 'roaring-koel' -  > Running set_working_directory step...
08:28:08.619 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:08.624 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:08.630 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:08.631 | DEBUG   | Flow run 'roaring-koel' - Changing working directory to '/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/'
08:28:08.631 | DEBUG   | Flow run 'roaring-koel' - Importing flow code from 'orch/flows/scheduled/send_morning_reminder_flow.py:send_morning_reminder_flow'
08:28:09.107 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:09.142 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:28:09.144 | INFO    | Flow run 'roaring-koel' - Beginning flow run 'roaring-koel' for flow 'Scheduled - Morning Wake Up Reminder'
08:28:09.144 | INFO    | Flow run 'roaring-koel' - View at http://0.0.0.0:4201/runs/flow-run/a80a9968-4f21-4706-8b76-75b73713fb25
08:28:09.145 | DEBUG   | Flow run 'roaring-koel' - Executing flow 'Scheduled - Morning Wake Up Reminder' for flow run 'roaring-koel'...
08:28:09.228 | DEBUG   | prefect.client - Received response with retryable status code 503. Another attempt will be made in 4.7865221977071855s. This is attempt 2/6.
08:28:09.401 | INFO    | prefect.engine - View at http://0.0.0.0:4201/runs/flow-run/266f9693-09a3-4ffc-92a6-2f39ad88ab8f
08:28:09.423 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:28:09.424 | INFO    | Flow run 'yellow-jaguarundi' - Beginning subflow run 'yellow-jaguarundi' for flow 'Send Reminder Message Flow'
08:28:09.424 | INFO    | Flow run 'yellow-jaguarundi' - View at http://0.0.0.0:4201/runs/flow-run/266f9693-09a3-4ffc-92a6-2f39ad88ab8f
08:28:09.424 | DEBUG   | Flow run 'yellow-jaguarundi' - Executing flow 'Send Reminder Message Flow' for flow run 'yellow-jaguarundi'...
08:28:09.425 | INFO    | Flow run 'yellow-jaguarundi' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Sending to platform='slack', destination='uat_channel'
08:28:09.425 | INFO    | Flow run 'yellow-jaguarundi' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Resolved mentions: ['U08J619BW3B']
08:28:09.426 | INFO    | Flow run 'yellow-jaguarundi' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Publishing reminder message task...
08:28:09.432 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-a14' - Created task run 'Build, Publish Initial Reminder & Record State-a14' for task 'Build, Publish Initial Reminder & Record State'
08:28:09.433 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-a14' - Executing task 'Build, Publish Initial Reminder & Record State' for task run 'Build, Publish Initial Reminder & Record State-a14'...
08:28:09.438 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-a14' - Task started: channel='slack', template='SlackReminderTemplate' (RemID: 16acf62a-39db-478f-a7a0-1b944861466c)
08:28:09.438 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-a14' - Received context keys: ['destination_alias', 'mention_aliases', 'interaction_mode', 'main_text', 'sub_text', 'follow_up_policy', 'mentions', 'recipient', 'reminder_id']
08:28:09.439 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-a14' - Processed placeholders in 'main_text' (RemID: 16acf62a-39db-478f-a7a0-1b944861466c)
08:28:09.439 | DEBUG   | prefect.events.clients - Reconnecting websocket connection.
08:28:09.439 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-a14' - Processed placeholders in 'sub_text' (RemID: 16acf62a-39db-478f-a7a0-1b944861466c)
08:28:09.440 | DEBUG   | prefect.events.clients - Opening websocket connection.
08:28:09.440 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-a14' - Processed placeholders in 'follow_up_policy.thread_message_template' (RemID: 16acf62a-39db-478f-a7a0-1b944861466c)
08:28:09.441 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-a14' - Prepended Slack mentions to main_text (RemID: 16acf62a-39db-478f-a7a0-1b944861466c).
08:28:09.441 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-a14' - Prepared task message for Slack with 'payload' dictionary (RemID: 16acf62a-39db-478f-a7a0-1b944861466c).
08:28:09.441 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-a14' - Publishing initial reminder task to list 'slack_message_send_queue' (RemID: 16acf62a-39db-478f-a7a0-1b944861466c).
08:28:09.444 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-a14' - Successfully published initial reminder task to 'slack_message_send_queue' (RemID: 16acf62a-39db-478f-a7a0-1b944861466c).
08:28:09.444 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-a14' - Follow-up policy found. Recording state and scheduling next check (RemID: 16acf62a-39db-478f-a7a0-1b944861466c).
08:28:09.445 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-a14' - Saved initial state for 16acf62a-39db-478f-a7a0-1b944861466c to Redis hash 'reminder:state:16acf62a-39db-478f-a7a0-1b944861466c'.
08:28:09.445 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-a14' - Adding reminder 16acf62a-39db-478f-a7a0-1b944861466c to schedule ZSET 'reminder:followup_schedule' with score 1743640099 (2025-04-03T00:28:19.444877+00:00).
08:28:09.446 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-a14' - Successfully added/updated 16acf62a-39db-478f-a7a0-1b944861466c in schedule ZSET (ZADD returned 1).
08:28:09.447 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-a14' - Finished in state Completed()
08:28:09.447 | INFO    | Flow run 'yellow-jaguarundi' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Reminder message successfully published.
08:28:09.447 | DEBUG   | prefect.events.clients - Pinging to ensure websocket connected.
08:28:09.448 | INFO    | Flow run 'yellow-jaguarundi' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Sending to platform='line', destination='bacon_dm'
08:28:09.448 | INFO    | Flow run 'yellow-jaguarundi' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Resolved mentions: ['Uccaf1be8b6335a9827558bfbec6769f1']
08:28:09.448 | INFO    | Flow run 'yellow-jaguarundi' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Publishing reminder message task...
08:28:09.449 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-397' - Created task run 'Build, Publish Initial Reminder & Record State-397' for task 'Build, Publish Initial Reminder & Record State'
08:28:09.450 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-397' - Executing task 'Build, Publish Initial Reminder & Record State' for task run 'Build, Publish Initial Reminder & Record State-397'...
08:28:09.450 | DEBUG   | prefect.events.clients - Pong received. Websocket connected.
08:28:09.450 | DEBUG   | prefect.events.clients - Resending 0 unconfirmed events.
08:28:09.450 | DEBUG   | prefect.events.clients - Finished resending unconfirmed events.
08:28:09.451 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:28:09.456 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-397' - Task started: channel='line', template='LineReminderTemplate' (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762)
08:28:09.457 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-397' - Received context keys: ['destination_alias', 'mention_aliases', 'interaction_mode', 'main_text', 'follow_up_policy', 'mentions', 'recipient', 'sub_text', 'reminder_id']
08:28:09.457 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-397' - Processed placeholders in 'main_text' (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762)
08:28:09.457 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-397' - Processed placeholders in 'sub_text' (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762)
08:28:09.458 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-397' - Processed placeholders in 'follow_up_policy.thread_message_template' (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762)
08:28:09.458 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-397' - Payload: [FlexMessage(type='flex', quick_reply=None, sender=None, alt_text='Reminder: 早安 ☀️ 請點擊按鈕確認你醒著！', contents=FlexBubble(type='bubble', direction=None, styles=None, header=None, hero=None, body=FlexBox(type='box', layout='vertical', flex=None, contents=[FlexText(type='text', flex=None, text='@User1', size=None, align=None, gravity=None, color=None, weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='早安 ☀️ 請點擊按鈕確認你醒著！', size=None, align=None, gravity=None, color=None, weight='bold', style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='時間: 04/03 08:28', size='xs', align=None, gravity=None, color='#aaaaaa', weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None)], spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), footer=FlexBox(type='box', layout='vertical', flex=0, contents=[FlexButton(type='button', flex=None, color=None, style='primary', action=PostbackAction(type='postback', label='知道了', data='action=acknowledge&reminder_id=d1a44283-1c92-44d0-bea4-7ece3da83762', display_text=None, text=None, input_option=None, fill_in_text=None), gravity=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, height='sm', adjust_mode=None, scaling=None)], spacing='sm', margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), size=None, action=None))]
08:28:09.459 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-397' - Prepared task message for Line with 'payload_pickle' string (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762).
08:28:09.459 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-397' - Publishing initial reminder task to list 'line_push_message_queue' (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762).
08:28:09.460 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-397' - Successfully published initial reminder task to 'line_push_message_queue' (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762).
08:28:09.461 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-397' - Follow-up policy found. Recording state and scheduling next check (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762).
08:28:09.461 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-397' - Saved initial state for d1a44283-1c92-44d0-bea4-7ece3da83762 to Redis hash 'reminder:state:d1a44283-1c92-44d0-bea4-7ece3da83762'.
08:28:09.462 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-397' - Adding reminder d1a44283-1c92-44d0-bea4-7ece3da83762 to schedule ZSET 'reminder:followup_schedule' with score 1743640099 (2025-04-03T00:28:19.461536+00:00).
08:28:09.462 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-397' - Successfully added/updated d1a44283-1c92-44d0-bea4-7ece3da83762 in schedule ZSET (ZADD returned 1).
08:28:09.463 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-397' - Finished in state Completed()
08:28:09.464 | INFO    | Flow run 'yellow-jaguarundi' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Reminder message successfully published.
08:28:09.465 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emitting event id=a67bded0-22d8-4d91-a2e7-11d7c8cd0eac.
08:28:09.465 | DEBUG   | prefect.events.clients - Added event id=a67bded0-22d8-4d91-a2e7-11d7c8cd0eac to unconfirmed events list. There are now 1 unconfirmed events.
08:28:09.465 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emit reconnection attempt 0.
08:28:09.465 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Sending event id=a67bded0-22d8-4d91-a2e7-11d7c8cd0eac.
08:28:09.466 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Checkpointing event id=a67bded0-22d8-4d91-a2e7-11d7c8cd0eac.
08:28:09.466 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emitting event id=3f2efa5f-d79c-4f0d-9cb9-76d8bebe8b3d.
08:28:09.467 | DEBUG   | prefect.events.clients - Added event id=3f2efa5f-d79c-4f0d-9cb9-76d8bebe8b3d to unconfirmed events list. There are now 2 unconfirmed events.
08:28:09.467 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emit reconnection attempt 0.
08:28:09.467 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Sending event id=3f2efa5f-d79c-4f0d-9cb9-76d8bebe8b3d.
08:28:09.467 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Checkpointing event id=3f2efa5f-d79c-4f0d-9cb9-76d8bebe8b3d.
08:28:09.468 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emitting event id=ed945d65-8b48-4d4d-b1d2-dee0279c8fe7.
08:28:09.468 | DEBUG   | prefect.events.clients - Added event id=ed945d65-8b48-4d4d-b1d2-dee0279c8fe7 to unconfirmed events list. There are now 3 unconfirmed events.
08:28:09.468 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emit reconnection attempt 0.
08:28:09.468 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Sending event id=ed945d65-8b48-4d4d-b1d2-dee0279c8fe7.
08:28:09.469 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Checkpointing event id=ed945d65-8b48-4d4d-b1d2-dee0279c8fe7.
08:28:09.469 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emitting event id=0138e8dc-9ede-442b-969a-f22defc16779.
08:28:09.470 | DEBUG   | prefect.events.clients - Added event id=0138e8dc-9ede-442b-969a-f22defc16779 to unconfirmed events list. There are now 4 unconfirmed events.
08:28:09.470 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emit reconnection attempt 0.
08:28:09.470 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Sending event id=0138e8dc-9ede-442b-969a-f22defc16779.
08:28:09.470 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Checkpointing event id=0138e8dc-9ede-442b-969a-f22defc16779.
08:28:09.471 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emitting event id=2f845d05-dd6a-494d-9d2b-7ac25e5c82ec.
08:28:09.471 | DEBUG   | prefect.events.clients - Added event id=2f845d05-dd6a-494d-9d2b-7ac25e5c82ec to unconfirmed events list. There are now 5 unconfirmed events.
08:28:09.471 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emit reconnection attempt 0.
08:28:09.471 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Sending event id=2f845d05-dd6a-494d-9d2b-7ac25e5c82ec.
08:28:09.471 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Checkpointing event id=2f845d05-dd6a-494d-9d2b-7ac25e5c82ec.
08:28:09.472 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emitting event id=45e2ae80-1578-49a2-b41b-0d2bf6c6ca98.
08:28:09.472 | DEBUG   | prefect.events.clients - Added event id=45e2ae80-1578-49a2-b41b-0d2bf6c6ca98 to unconfirmed events list. There are now 6 unconfirmed events.
08:28:09.472 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Emit reconnection attempt 0.
08:28:09.472 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Sending event id=45e2ae80-1578-49a2-b41b-0d2bf6c6ca98.
08:28:09.472 | DEBUG   | prefect.events.clients - EventsClient(id=4489695808): Checkpointing event id=45e2ae80-1578-49a2-b41b-0d2bf6c6ca98.
08:28:09.495 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:28:09.495 | INFO    | Flow run 'yellow-jaguarundi' - Finished in state Completed()
08:28:09.520 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:28:09.521 | INFO    | Flow run 'roaring-koel' - Finished in state Completed()
08:28:09.742 | INFO    | prefect.flow_runs.runner - Process for flow run 'roaring-koel' exited cleanly.
08:28:14.038 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:28:15.375 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x104e4cd30>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106ec9420>>)
08:28:15.376 | DEBUG   | prefect.runner - Runner has no active flow runs or deployments. Sending message to loop service that no further cancellation checks are needed.
08:28:15.376 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:28:15.378 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=1a2d153f-e429-4d7d-825a-082b45125935.
08:28:15.378 | DEBUG   | prefect.events.clients - Added event id=1a2d153f-e429-4d7d-825a-082b45125935 to unconfirmed events list. There are now 3 unconfirmed events.
08:28:15.378 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:28:15.379 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=1a2d153f-e429-4d7d-825a-082b45125935.
08:28:15.379 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=1a2d153f-e429-4d7d-825a-082b45125935.
08:28:16.592 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:28:16.593 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:28:26.593249+00:00
08:28:16.601 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:28:25.658 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:28:25.658 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:28:35.658777+00:00
08:28:25.679 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:28:35.876 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:28:35.880 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:28:45.879977+00:00
08:28:35.906 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:28:44.927 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:28:44.959 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:28:46.815 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:28:46.817 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:28:56.817341+00:00
08:28:46.839 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:28:57.520 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:28:57.523 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:29:07.523394+00:00
08:28:57.544 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:29:06.863 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:29:06.865 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:29:16.865309+00:00
08:29:06.892 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:29:18.748 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:29:18.751 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:29:28.751352+00:00
08:29:18.775 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:29:21.441 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:29:21.465 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:29:26.683 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:29:26.686 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:29:36.686418+00:00
08:29:26.708 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:29:34.413 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:29:34.415 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:29:44.415693+00:00
08:29:34.435 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:29:46.612 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:29:46.614 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:29:56.613899+00:00
08:29:46.639 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:29:57.584 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:29:57.618 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:29:58.144 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:29:58.145 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:30:08.145188+00:00
08:29:58.153 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 2 scheduled_flow_runs
08:29:58.154 | INFO    | prefect.flow_runs.worker - Worker 'ProcessWorker 853e55ce-760a-4c45-884f-563721ceeb78' submitting flow run '0eb70528-29c3-4388-8bc4-670f58022144'
08:29:58.154 | INFO    | prefect.flow_runs.worker - Worker 'ProcessWorker 853e55ce-760a-4c45-884f-563721ceeb78' submitting flow run 'b71d9612-2de2-4d4d-97ef-e1a36e24755c'
08:29:58.193 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Ready to submit 0eb70528-29c3-4388-8bc4-670f58022144: True
08:29:58.210 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=9dacab61-60d6-4521-b254-bc142d76b369.
08:29:58.210 | DEBUG   | prefect.events.clients - Added event id=9dacab61-60d6-4521-b254-bc142d76b369 to unconfirmed events list. There are now 4 unconfirmed events.
08:29:58.210 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:29:58.211 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=9dacab61-60d6-4521-b254-bc142d76b369.
08:29:58.211 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=9dacab61-60d6-4521-b254-bc142d76b369.
08:29:58.223 | DEBUG   | prefect.client - Received response with retryable status code 503. Another attempt will be made in 1.7438500537962878s. This is attempt 1/6.
08:29:58.240 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Ready to submit b71d9612-2de2-4d4d-97ef-e1a36e24755c: True
08:29:58.255 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=2cec5c8d-86eb-4413-a87a-3b76dc3a6d2b.
08:29:58.255 | DEBUG   | prefect.events.clients - Added event id=2cec5c8d-86eb-4413-a87a-3b76dc3a6d2b to unconfirmed events list. There are now 5 unconfirmed events.
08:29:58.255 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:29:58.256 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=2cec5c8d-86eb-4413-a87a-3b76dc3a6d2b.
08:29:58.256 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=2cec5c8d-86eb-4413-a87a-3b76dc3a6d2b.
08:29:58.279 | INFO    | prefect.flow_runs.runner - Opening process...
08:29:58.291 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103c839a0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106ec8e80>>)
08:29:58.291 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:29:58.297 | INFO    | prefect.flow_runs.worker - Completed submission of flow run 'b71d9612-2de2-4d4d-97ef-e1a36e24755c'
08:29:59.356 | DEBUG   | prefect.profiles - Using profile 'uat'
08:29:59.496 | DEBUG   | Flow run 'original-aardwark' - Running 1 deployment pull step(s)
08:29:59.504 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:29:59.507 | INFO    | Flow run 'original-aardwark' -  > Running set_working_directory step...
08:29:59.512 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:29:59.519 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:29:59.520 | DEBUG   | Flow run 'original-aardwark' - Changing working directory to '/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/'
08:29:59.520 | DEBUG   | Flow run 'original-aardwark' - Importing flow code from 'orch/flows/scheduled/send_morning_reminder_flow.py:send_morning_reminder_flow'
08:29:59.979 | INFO    | prefect.flow_runs.runner - Opening process...
08:29:59.992 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103f4cca0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106fbc7c0>>)
08:29:59.992 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:30:00.001 | INFO    | prefect.flow_runs.worker - Completed submission of flow run '0eb70528-29c3-4388-8bc4-670f58022144'
08:30:00.067 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:30:00.101 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:30:00.102 | INFO    | Flow run 'original-aardwark' - Beginning flow run 'original-aardwark' for flow 'Scheduled - Morning Wake Up Reminder'
08:30:00.102 | INFO    | Flow run 'original-aardwark' - View at http://0.0.0.0:4201/runs/flow-run/b71d9612-2de2-4d4d-97ef-e1a36e24755c
08:30:00.102 | DEBUG   | Flow run 'original-aardwark' - Executing flow 'Scheduled - Morning Wake Up Reminder' for flow run 'original-aardwark'...
08:30:00.311 | INFO    | prefect.engine - View at http://0.0.0.0:4201/runs/flow-run/5b85d405-11b0-4f35-bf1c-fcab031cac6e
08:30:00.336 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:30:00.337 | INFO    | Flow run 'polar-centipede' - Beginning subflow run 'polar-centipede' for flow 'Send Reminder Message Flow'
08:30:00.338 | INFO    | Flow run 'polar-centipede' - View at http://0.0.0.0:4201/runs/flow-run/5b85d405-11b0-4f35-bf1c-fcab031cac6e
08:30:00.338 | DEBUG   | Flow run 'polar-centipede' - Executing flow 'Send Reminder Message Flow' for flow run 'polar-centipede'...
08:30:00.338 | INFO    | Flow run 'polar-centipede' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Sending to platform='slack', destination='uat_channel'
08:30:00.339 | INFO    | Flow run 'polar-centipede' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Resolved mentions: ['U08J619BW3B']
08:30:00.339 | INFO    | Flow run 'polar-centipede' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Publishing reminder message task...
08:30:00.347 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-93b' - Created task run 'Build, Publish Initial Reminder & Record State-93b' for task 'Build, Publish Initial Reminder & Record State'
08:30:00.348 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-93b' - Executing task 'Build, Publish Initial Reminder & Record State' for task run 'Build, Publish Initial Reminder & Record State-93b'...
08:30:00.354 | DEBUG   | prefect.events.clients - Reconnecting websocket connection.
08:30:00.354 | DEBUG   | prefect.events.clients - Opening websocket connection.
08:30:00.354 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-93b' - Task started: channel='slack', template='SlackReminderTemplate' (RemID: a03cf709-854b-429d-91ee-a4b52bf38685)
08:30:00.355 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-93b' - Received context keys: ['destination_alias', 'mention_aliases', 'interaction_mode', 'main_text', 'sub_text', 'follow_up_policy', 'mentions', 'recipient', 'reminder_id']
08:30:00.355 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-93b' - Processed placeholders in 'main_text' (RemID: a03cf709-854b-429d-91ee-a4b52bf38685)
08:30:00.355 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-93b' - Processed placeholders in 'sub_text' (RemID: a03cf709-854b-429d-91ee-a4b52bf38685)
08:30:00.356 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-93b' - Processed placeholders in 'follow_up_policy.thread_message_template' (RemID: a03cf709-854b-429d-91ee-a4b52bf38685)
08:30:00.356 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-93b' - Prepended Slack mentions to main_text (RemID: a03cf709-854b-429d-91ee-a4b52bf38685).
08:30:00.356 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-93b' - Prepared task message for Slack with 'payload' dictionary (RemID: a03cf709-854b-429d-91ee-a4b52bf38685).
08:30:00.357 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-93b' - Publishing initial reminder task to list 'slack_message_send_queue' (RemID: a03cf709-854b-429d-91ee-a4b52bf38685).
08:30:00.359 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-93b' - Successfully published initial reminder task to 'slack_message_send_queue' (RemID: a03cf709-854b-429d-91ee-a4b52bf38685).
08:30:00.360 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-93b' - Follow-up policy found. Recording state and scheduling next check (RemID: a03cf709-854b-429d-91ee-a4b52bf38685).
08:30:00.360 | DEBUG   | prefect.events.clients - Pinging to ensure websocket connected.
08:30:00.361 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-93b' - Saved initial state for a03cf709-854b-429d-91ee-a4b52bf38685 to Redis hash 'reminder:state:a03cf709-854b-429d-91ee-a4b52bf38685'.
08:30:00.361 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-93b' - Adding reminder a03cf709-854b-429d-91ee-a4b52bf38685 to schedule ZSET 'reminder:followup_schedule' with score 1743640210 (2025-04-03T00:30:10.360773+00:00).
08:30:00.362 | DEBUG   | prefect.events.clients - Pong received. Websocket connected.
08:30:00.362 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-93b' - Successfully added/updated a03cf709-854b-429d-91ee-a4b52bf38685 in schedule ZSET (ZADD returned 1).
08:30:00.362 | DEBUG   | prefect.events.clients - Resending 0 unconfirmed events.
08:30:00.362 | DEBUG   | prefect.events.clients - Finished resending unconfirmed events.
08:30:00.363 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:30:00.364 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-93b' - Finished in state Completed()
08:30:00.364 | INFO    | Flow run 'polar-centipede' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Reminder message successfully published.
08:30:00.365 | INFO    | Flow run 'polar-centipede' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Sending to platform='line', destination='bacon_dm'
08:30:00.365 | INFO    | Flow run 'polar-centipede' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Resolved mentions: ['Uccaf1be8b6335a9827558bfbec6769f1']
08:30:00.365 | INFO    | Flow run 'polar-centipede' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Publishing reminder message task...
08:30:00.366 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-946' - Created task run 'Build, Publish Initial Reminder & Record State-946' for task 'Build, Publish Initial Reminder & Record State'
08:30:00.367 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-946' - Executing task 'Build, Publish Initial Reminder & Record State' for task run 'Build, Publish Initial Reminder & Record State-946'...
08:30:00.372 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-946' - Task started: channel='line', template='LineReminderTemplate' (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04)
08:30:00.372 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-946' - Received context keys: ['destination_alias', 'mention_aliases', 'interaction_mode', 'main_text', 'follow_up_policy', 'mentions', 'recipient', 'sub_text', 'reminder_id']
08:30:00.373 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-946' - Processed placeholders in 'main_text' (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04)
08:30:00.373 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-946' - Processed placeholders in 'sub_text' (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04)
08:30:00.373 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-946' - Processed placeholders in 'follow_up_policy.thread_message_template' (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04)
08:30:00.374 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-946' - Payload: [FlexMessage(type='flex', quick_reply=None, sender=None, alt_text='Reminder: 早安 ☀️ 請點擊按鈕確認你醒著！', contents=FlexBubble(type='bubble', direction=None, styles=None, header=None, hero=None, body=FlexBox(type='box', layout='vertical', flex=None, contents=[FlexText(type='text', flex=None, text='@User1', size=None, align=None, gravity=None, color=None, weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='早安 ☀️ 請點擊按鈕確認你醒著！', size=None, align=None, gravity=None, color=None, weight='bold', style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='時間: 04/03 08:30', size='xs', align=None, gravity=None, color='#aaaaaa', weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None)], spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), footer=FlexBox(type='box', layout='vertical', flex=0, contents=[FlexButton(type='button', flex=None, color=None, style='primary', action=PostbackAction(type='postback', label='知道了', data='action=acknowledge&reminder_id=73e5ef18-5ec0-42aa-8fe0-8167e14abb04', display_text=None, text=None, input_option=None, fill_in_text=None), gravity=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, height='sm', adjust_mode=None, scaling=None)], spacing='sm', margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), size=None, action=None))]
08:30:00.375 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-946' - Prepared task message for Line with 'payload_pickle' string (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04).
08:30:00.375 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-946' - Publishing initial reminder task to list 'line_push_message_queue' (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04).
08:30:00.376 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-946' - Successfully published initial reminder task to 'line_push_message_queue' (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04).
08:30:00.377 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-946' - Follow-up policy found. Recording state and scheduling next check (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04).
08:30:00.377 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-946' - Saved initial state for 73e5ef18-5ec0-42aa-8fe0-8167e14abb04 to Redis hash 'reminder:state:73e5ef18-5ec0-42aa-8fe0-8167e14abb04'.
08:30:00.378 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-946' - Adding reminder 73e5ef18-5ec0-42aa-8fe0-8167e14abb04 to schedule ZSET 'reminder:followup_schedule' with score 1743640210 (2025-04-03T00:30:10.377318+00:00).
08:30:00.378 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-946' - Successfully added/updated 73e5ef18-5ec0-42aa-8fe0-8167e14abb04 in schedule ZSET (ZADD returned 1).
08:30:00.379 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-946' - Finished in state Completed()
08:30:00.380 | INFO    | Flow run 'polar-centipede' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Reminder message successfully published.
08:30:00.381 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emitting event id=299975db-60ff-4d1e-888a-92332e2de3e6.
08:30:00.381 | DEBUG   | prefect.events.clients - Added event id=299975db-60ff-4d1e-888a-92332e2de3e6 to unconfirmed events list. There are now 1 unconfirmed events.
08:30:00.381 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emit reconnection attempt 0.
08:30:00.381 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Sending event id=299975db-60ff-4d1e-888a-92332e2de3e6.
08:30:00.382 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Checkpointing event id=299975db-60ff-4d1e-888a-92332e2de3e6.
08:30:00.383 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emitting event id=ee73c737-686b-49bf-ac17-4ef119201c2e.
08:30:00.383 | DEBUG   | prefect.events.clients - Added event id=ee73c737-686b-49bf-ac17-4ef119201c2e to unconfirmed events list. There are now 2 unconfirmed events.
08:30:00.383 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emit reconnection attempt 0.
08:30:00.384 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Sending event id=ee73c737-686b-49bf-ac17-4ef119201c2e.
08:30:00.384 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Checkpointing event id=ee73c737-686b-49bf-ac17-4ef119201c2e.
08:30:00.385 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emitting event id=b8442da1-443a-4191-bd84-f94dc5dd74f5.
08:30:00.385 | DEBUG   | prefect.events.clients - Added event id=b8442da1-443a-4191-bd84-f94dc5dd74f5 to unconfirmed events list. There are now 3 unconfirmed events.
08:30:00.385 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emit reconnection attempt 0.
08:30:00.385 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Sending event id=b8442da1-443a-4191-bd84-f94dc5dd74f5.
08:30:00.385 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Checkpointing event id=b8442da1-443a-4191-bd84-f94dc5dd74f5.
08:30:00.386 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emitting event id=a1f40fe3-52b2-48df-b047-0fed9516b41d.
08:30:00.386 | DEBUG   | prefect.events.clients - Added event id=a1f40fe3-52b2-48df-b047-0fed9516b41d to unconfirmed events list. There are now 4 unconfirmed events.
08:30:00.387 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emit reconnection attempt 0.
08:30:00.387 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Sending event id=a1f40fe3-52b2-48df-b047-0fed9516b41d.
08:30:00.387 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Checkpointing event id=a1f40fe3-52b2-48df-b047-0fed9516b41d.
08:30:00.388 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emitting event id=91772e02-d3c6-40db-ad1d-a9aac608a324.
08:30:00.388 | DEBUG   | prefect.events.clients - Added event id=91772e02-d3c6-40db-ad1d-a9aac608a324 to unconfirmed events list. There are now 5 unconfirmed events.
08:30:00.388 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emit reconnection attempt 0.
08:30:00.388 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Sending event id=91772e02-d3c6-40db-ad1d-a9aac608a324.
08:30:00.388 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Checkpointing event id=91772e02-d3c6-40db-ad1d-a9aac608a324.
08:30:00.389 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emitting event id=b56fc893-6c35-4c4e-9e93-bd2a687da796.
08:30:00.389 | DEBUG   | prefect.events.clients - Added event id=b56fc893-6c35-4c4e-9e93-bd2a687da796 to unconfirmed events list. There are now 6 unconfirmed events.
08:30:00.389 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Emit reconnection attempt 0.
08:30:00.389 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Sending event id=b56fc893-6c35-4c4e-9e93-bd2a687da796.
08:30:00.389 | DEBUG   | prefect.events.clients - EventsClient(id=4505195072): Checkpointing event id=b56fc893-6c35-4c4e-9e93-bd2a687da796.
08:30:00.410 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:30:00.411 | INFO    | Flow run 'polar-centipede' - Finished in state Completed()
08:30:00.430 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:30:00.430 | INFO    | Flow run 'original-aardwark' - Finished in state Completed()
08:30:00.690 | INFO    | prefect.flow_runs.runner - Process for flow run 'original-aardwark' exited cleanly.
08:30:00.778 | DEBUG   | prefect.profiles - Using profile 'uat'
08:30:00.943 | DEBUG   | Flow run 'vehement-nautilus' - Running 1 deployment pull step(s)
08:30:00.950 | INFO    | Flow run 'vehement-nautilus' -  > Running set_working_directory step...
08:30:00.951 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:30:00.956 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:30:00.962 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:30:00.963 | DEBUG   | Flow run 'vehement-nautilus' - Changing working directory to '/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/'
08:30:00.963 | DEBUG   | Flow run 'vehement-nautilus' - Importing flow code from 'orch/flows/scheduled/launch_due_reminder_checks_flow.py:launch_due_reminder_checks_flow'
08:30:01.452 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:30:01.452 | INFO    | Flow run 'vehement-nautilus' - Beginning flow run 'vehement-nautilus' for flow 'Example - Send Reminder Message'
08:30:01.453 | INFO    | Flow run 'vehement-nautilus' - View at http://0.0.0.0:4201/runs/flow-run/0eb70528-29c3-4388-8bc4-670f58022144
08:30:01.453 | DEBUG   | Flow run 'vehement-nautilus' - Executing flow 'Example - Send Reminder Message' for flow run 'vehement-nautilus'...
08:30:01.456 | INFO    | Flow run 'vehement-nautilus' - Found 2 due reminder(s). Launching follow-up flows...
08:30:01.469 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:30:01.665 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:30:01.666 | INFO    | Flow run 'elastic-rat' - Beginning subflow run 'elastic-rat' for flow 'Send Follow-up Reminder'
08:30:01.667 | INFO    | Flow run 'elastic-rat' - View at http://0.0.0.0:4201/runs/flow-run/c789741b-cbe2-4099-805d-010231b8b72a
08:30:01.667 | DEBUG   | Flow run 'elastic-rat' - Executing flow 'Send Follow-up Reminder' for flow run 'elastic-rat'...
08:30:01.667 | INFO    | Flow run 'elastic-rat' - Starting follow-up flow for reminder_id: 16acf62a-39db-478f-a7a0-1b944861466c
08:30:01.689 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:30:01.690 | INFO    | Flow run 'elastic-rat' - Finished in state Completed()
08:30:01.696 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:30:01.703 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-6e8' - Created task run 'Build and Publish Follow-up Reminder Message-6e8' for task 'Build and Publish Follow-up Reminder Message'
08:30:01.704 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-6e8' - Executing task 'Build and Publish Follow-up Reminder Message' for task run 'Build and Publish Follow-up Reminder Message-6e8'...
08:30:01.708 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-6e8' - [FollowUp:16acf62a] Fetching reminder state from Redis
08:30:01.708 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-6e8' - [FollowUp:16acf62a] Payload built: {'type': 'reminder_followup', 'text': '<@U08J619BW3B> Good morning!. 尚未處理！', 'sub_text': "Please click the button to confirm you're alive.\n時間: 04/03 08:28", 'thread_ts': '1743640089.708529'}
08:30:01.709 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-6e8' - [FollowUp:16acf62a] Follow-up reminder enqueued to slack_message_send_queue.
08:30:01.709 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-6e8' - Finished in state Completed()
08:30:01.710 | DEBUG   | prefect.events.clients - Reconnecting websocket connection.
08:30:01.710 | DEBUG   | prefect.events.clients - Opening websocket connection.
08:30:01.711 | INFO    | Flow run 'vehement-nautilus' - Triggered follow-up flow for reminder 16acf62a-39db-478f-a7a0-1b944861466c.
08:30:01.715 | DEBUG   | prefect.events.clients - Pinging to ensure websocket connected.
08:30:01.715 | DEBUG   | prefect.events.clients - Pong received. Websocket connected.
08:30:01.715 | DEBUG   | prefect.events.clients - Resending 0 unconfirmed events.
08:30:01.716 | DEBUG   | prefect.events.clients - Finished resending unconfirmed events.
08:30:01.716 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:30:01.717 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:30:01.740 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emitting event id=73aa79fc-04e0-47f0-8644-87f121bf5fae.
08:30:01.740 | DEBUG   | prefect.events.clients - Added event id=73aa79fc-04e0-47f0-8644-87f121bf5fae to unconfirmed events list. There are now 1 unconfirmed events.
08:30:01.740 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emit reconnection attempt 0.
08:30:01.740 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Sending event id=73aa79fc-04e0-47f0-8644-87f121bf5fae.
08:30:01.740 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Checkpointing event id=73aa79fc-04e0-47f0-8644-87f121bf5fae.
08:30:01.741 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emitting event id=a2209fb1-db4d-4a60-ab62-c29e7755df43.
08:30:01.741 | DEBUG   | prefect.events.clients - Added event id=a2209fb1-db4d-4a60-ab62-c29e7755df43 to unconfirmed events list. There are now 2 unconfirmed events.
08:30:01.741 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emit reconnection attempt 0.
08:30:01.742 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Sending event id=a2209fb1-db4d-4a60-ab62-c29e7755df43.
08:30:01.742 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Checkpointing event id=a2209fb1-db4d-4a60-ab62-c29e7755df43.
08:30:01.742 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emitting event id=a2d850d0-234a-418e-bf2a-3a964d4930f2.
08:30:01.742 | DEBUG   | prefect.events.clients - Added event id=a2d850d0-234a-418e-bf2a-3a964d4930f2 to unconfirmed events list. There are now 3 unconfirmed events.
08:30:01.742 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emit reconnection attempt 0.
08:30:01.743 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Sending event id=a2d850d0-234a-418e-bf2a-3a964d4930f2.
08:30:01.743 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Checkpointing event id=a2d850d0-234a-418e-bf2a-3a964d4930f2.
08:30:01.802 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:30:01.802 | INFO    | Flow run 'wandering-bonobo' - Beginning subflow run 'wandering-bonobo' for flow 'Send Follow-up Reminder'
08:30:01.803 | INFO    | Flow run 'wandering-bonobo' - View at http://0.0.0.0:4201/runs/flow-run/88db14c2-ac22-4fe0-b61e-71d00e2acb2c
08:30:01.803 | DEBUG   | Flow run 'wandering-bonobo' - Executing flow 'Send Follow-up Reminder' for flow run 'wandering-bonobo'...
08:30:01.803 | INFO    | Flow run 'wandering-bonobo' - Starting follow-up flow for reminder_id: d1a44283-1c92-44d0-bea4-7ece3da83762
08:30:01.828 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:30:01.828 | INFO    | Flow run 'wandering-bonobo' - Finished in state Completed()
08:30:01.835 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:30:01.840 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-cbb' - Created task run 'Build and Publish Follow-up Reminder Message-cbb' for task 'Build and Publish Follow-up Reminder Message'
08:30:01.841 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-cbb' - Executing task 'Build and Publish Follow-up Reminder Message' for task run 'Build and Publish Follow-up Reminder Message-cbb'...
08:30:01.843 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emitting event id=f7518606-eda1-451f-b361-b93798432b41.
08:30:01.843 | DEBUG   | prefect.events.clients - Added event id=f7518606-eda1-451f-b361-b93798432b41 to unconfirmed events list. There are now 4 unconfirmed events.
08:30:01.844 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emit reconnection attempt 0.
08:30:01.844 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Sending event id=f7518606-eda1-451f-b361-b93798432b41.
08:30:01.844 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Checkpointing event id=f7518606-eda1-451f-b361-b93798432b41.
08:30:01.845 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emitting event id=df3c543e-5db1-4e12-aa7f-5efb8b106a28.
08:30:01.845 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-cbb' - [FollowUp:d1a44283] Fetching reminder state from Redis
08:30:01.845 | DEBUG   | prefect.events.clients - Added event id=df3c543e-5db1-4e12-aa7f-5efb8b106a28 to unconfirmed events list. There are now 5 unconfirmed events.
08:30:01.846 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emit reconnection attempt 0.
08:30:01.846 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Sending event id=df3c543e-5db1-4e12-aa7f-5efb8b106a28.
08:30:01.846 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Checkpointing event id=df3c543e-5db1-4e12-aa7f-5efb8b106a28.
08:30:01.847 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-cbb' - [FollowUp:d1a44283] Payload built: [TextMessage(type='text', quick_reply=None, sender=None, text='報告 [N/A] 還沒好嗎？', emojis=None, quote_token=None)]
08:30:01.847 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-cbb' - [FollowUp:d1a44283] Follow-up reminder enqueued to line_push_message_queue.
08:30:01.848 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-cbb' - Finished in state Completed()
08:30:01.849 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emitting event id=7c3fa436-0c3b-4b01-8e5d-06001a628a97.
08:30:01.849 | DEBUG   | prefect.events.clients - Added event id=7c3fa436-0c3b-4b01-8e5d-06001a628a97 to unconfirmed events list. There are now 6 unconfirmed events.
08:30:01.850 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Emit reconnection attempt 0.
08:30:01.850 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Sending event id=7c3fa436-0c3b-4b01-8e5d-06001a628a97.
08:30:01.850 | INFO    | Flow run 'vehement-nautilus' - Triggered follow-up flow for reminder d1a44283-1c92-44d0-bea4-7ece3da83762.
08:30:01.850 | DEBUG   | prefect.events.clients - EventsClient(id=4683553792): Checkpointing event id=7c3fa436-0c3b-4b01-8e5d-06001a628a97.
08:30:01.873 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:30:01.873 | INFO    | Flow run 'vehement-nautilus' - Finished in state Completed()
08:30:02.089 | INFO    | prefect.flow_runs.runner - Process for flow run 'vehement-nautilus' exited cleanly.
08:30:05.846 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103c839a0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106ec8e80>>)
08:30:05.847 | DEBUG   | prefect.runner - Runner has no active flow runs or deployments. Sending message to loop service that no further cancellation checks are needed.
08:30:05.848 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:30:05.853 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=1e185ba2-77e5-4a98-b33c-b1442c72aa82.
08:30:05.854 | DEBUG   | prefect.events.clients - Added event id=1e185ba2-77e5-4a98-b33c-b1442c72aa82 to unconfirmed events list. There are now 6 unconfirmed events.
08:30:05.854 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:30:05.855 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=1e185ba2-77e5-4a98-b33c-b1442c72aa82.
08:30:05.856 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=1e185ba2-77e5-4a98-b33c-b1442c72aa82.
08:30:07.526 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:30:07.528 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:30:17.527821+00:00
08:30:07.552 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:30:12.655 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103f4cca0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106fbc7c0>>)
08:30:12.657 | DEBUG   | prefect.runner - Runner has no active flow runs or deployments. Sending message to loop service that no further cancellation checks are needed.
08:30:12.658 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:30:12.666 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=6f7f8f6d-f6a4-4fab-aa90-88e27ddd366b.
08:30:12.666 | DEBUG   | prefect.events.clients - Added event id=6f7f8f6d-f6a4-4fab-aa90-88e27ddd366b to unconfirmed events list. There are now 7 unconfirmed events.
08:30:12.666 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:30:12.667 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=6f7f8f6d-f6a4-4fab-aa90-88e27ddd366b.
08:30:12.667 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=6f7f8f6d-f6a4-4fab-aa90-88e27ddd366b.
08:30:16.985 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:30:16.987 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:30:26.986970+00:00
08:30:17.015 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:30:24.780 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:30:24.782 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:30:34.782476+00:00
08:30:24.805 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:30:34.411 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:30:34.437 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:30:37.644 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:30:37.646 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:30:47.646303+00:00
08:30:37.667 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:30:47.125 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:30:47.129 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:30:57.129514+00:00
08:30:47.158 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:30:54.741 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:30:54.744 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:31:04.744358+00:00
08:30:54.770 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:31:01.784 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:31:01.816 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:31:04.971 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:31:04.974 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:31:14.973798+00:00
08:31:04.998 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:31:15.901 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:31:15.903 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:31:25.903494+00:00
08:31:15.932 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:31:24.704 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:31:24.735 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:31:27.703 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:31:27.704 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:31:37.704378+00:00
08:31:27.728 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:31:36.476 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:31:36.479 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:31:46.479312+00:00
08:31:36.509 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:31:48.539 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:31:48.568 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:31:49.141 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:31:49.144 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:31:59.143415+00:00
08:31:49.167 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:31:59.619 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:31:59.623 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:32:09.622632+00:00
08:31:59.652 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:32:11.958 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:32:11.962 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:32:21.961781+00:00
08:32:11.985 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:32:22.651 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:32:22.676 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:32:22.849 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:32:22.851 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:32:32.850988+00:00
08:32:22.874 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:32:32.803 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:32:32.804 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:32:42.804169+00:00
08:32:32.823 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:32:43.416 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:32:43.417 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:32:53.416953+00:00
08:32:43.439 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:32:50.641 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:32:50.670 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:32:52.284 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:32:52.285 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:33:02.285309+00:00
08:32:52.294 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:33:04.775 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:33:04.779 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:33:14.777339+00:00
08:33:04.803 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:33:14.923 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:33:14.924 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:33:24.924155+00:00
08:33:14.948 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:33:18.894 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:33:18.912 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:33:24.964 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:33:24.966 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:33:34.966235+00:00
08:33:24.991 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:33:33.033 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:33:33.033 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:33:43.033731+00:00
08:33:33.049 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:33:40.741 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:33:40.742 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:33:50.742756+00:00
08:33:40.758 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:33:43.447 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:33:43.459 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:33:49.505 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:33:49.507 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:33:59.507233+00:00
08:33:49.529 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:33:59.001 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:33:59.001 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:34:09.001764+00:00
08:33:59.013 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:34:09.372 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:34:09.374 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:34:19.374292+00:00
08:34:09.394 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:34:15.446 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:34:15.465 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:34:19.626 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:34:19.626 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:34:29.626543+00:00
08:34:19.636 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:34:32.485 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:34:32.486 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:34:42.486841+00:00
08:34:32.507 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:34:40.064 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:34:40.066 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:34:50.065912+00:00
08:34:40.088 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:34:44.189 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:34:44.201 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:34:51.185 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:34:51.186 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:35:01.186261+00:00
08:34:51.206 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 1 scheduled_flow_runs
08:34:51.207 | INFO    | prefect.flow_runs.worker - Worker 'ProcessWorker 853e55ce-760a-4c45-884f-563721ceeb78' submitting flow run '4dfc75f1-95d8-4019-8bf5-fb2065d876ad'
08:34:51.362 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Ready to submit 4dfc75f1-95d8-4019-8bf5-fb2065d876ad: True
08:34:51.380 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=d638df8d-8cfb-4cbd-83f8-88feab97e98a.
08:34:51.381 | DEBUG   | prefect.events.clients - Added event id=d638df8d-8cfb-4cbd-83f8-88feab97e98a to unconfirmed events list. There are now 8 unconfirmed events.
08:34:51.381 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:34:51.381 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=d638df8d-8cfb-4cbd-83f8-88feab97e98a.
08:34:51.382 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=d638df8d-8cfb-4cbd-83f8-88feab97e98a.
08:34:51.394 | INFO    | prefect.flow_runs.runner - Opening process...
08:34:51.406 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103c857e0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106fbd0c0>>)
08:34:51.406 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:34:51.411 | INFO    | prefect.flow_runs.worker - Completed submission of flow run '4dfc75f1-95d8-4019-8bf5-fb2065d876ad'
08:34:55.957 | DEBUG   | prefect.profiles - Using profile 'uat'
08:34:56.472 | DEBUG   | Flow run 'armored-malamute' - Running 1 deployment pull step(s)
08:34:56.494 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:34:56.514 | INFO    | Flow run 'armored-malamute' -  > Running set_working_directory step...
08:34:56.523 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:34:56.535 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:34:56.537 | DEBUG   | Flow run 'armored-malamute' - Changing working directory to '/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/'
08:34:56.537 | DEBUG   | Flow run 'armored-malamute' - Importing flow code from 'orch/flows/scheduled/send_morning_reminder_flow.py:send_morning_reminder_flow'
08:34:58.218 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:34:58.245 | DEBUG   | prefect.engine - Received wait instruction for 2s: Scheduled time is in the future
08:35:00.271 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:35:00.272 | INFO    | Flow run 'armored-malamute' - Beginning flow run 'armored-malamute' for flow 'Scheduled - Morning Wake Up Reminder'
08:35:00.272 | INFO    | Flow run 'armored-malamute' - View at http://0.0.0.0:4201/runs/flow-run/4dfc75f1-95d8-4019-8bf5-fb2065d876ad
08:35:00.273 | DEBUG   | Flow run 'armored-malamute' - Executing flow 'Scheduled - Morning Wake Up Reminder' for flow run 'armored-malamute'...
08:35:00.644 | INFO    | prefect.engine - View at http://0.0.0.0:4201/runs/flow-run/0a5e8d2c-0fb7-4e00-a9f0-0b07fd6fb952
08:35:00.668 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:35:00.668 | INFO    | Flow run 'hallowed-whale' - Beginning subflow run 'hallowed-whale' for flow 'Send Reminder Message Flow'
08:35:00.669 | INFO    | Flow run 'hallowed-whale' - View at http://0.0.0.0:4201/runs/flow-run/0a5e8d2c-0fb7-4e00-a9f0-0b07fd6fb952
08:35:00.669 | DEBUG   | Flow run 'hallowed-whale' - Executing flow 'Send Reminder Message Flow' for flow run 'hallowed-whale'...
08:35:00.670 | INFO    | Flow run 'hallowed-whale' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Sending to platform='slack', destination='uat_channel'
08:35:00.670 | INFO    | Flow run 'hallowed-whale' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Resolved mentions: ['U08J619BW3B']
08:35:00.670 | INFO    | Flow run 'hallowed-whale' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Publishing reminder message task...
08:35:00.687 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Created task run 'Build, Publish Initial Reminder & Record State-ee2' for task 'Build, Publish Initial Reminder & Record State'
08:35:00.688 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Executing task 'Build, Publish Initial Reminder & Record State' for task run 'Build, Publish Initial Reminder & Record State-ee2'...
08:35:00.696 | DEBUG   | prefect.events.clients - Reconnecting websocket connection.
08:35:00.696 | DEBUG   | prefect.events.clients - Opening websocket connection.
08:35:00.697 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Task started: channel='slack', template='SlackReminderTemplate' (RemID: 2451cf2e-ace1-4a0b-854b-ec893bb26541)
08:35:00.697 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Received context keys: ['destination_alias', 'mention_aliases', 'interaction_mode', 'main_text', 'sub_text', 'follow_up_policy', 'mentions', 'recipient', 'reminder_id']
08:35:00.698 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Processed placeholders in 'main_text' (RemID: 2451cf2e-ace1-4a0b-854b-ec893bb26541)
08:35:00.698 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Processed placeholders in 'sub_text' (RemID: 2451cf2e-ace1-4a0b-854b-ec893bb26541)
08:35:00.698 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Processed placeholders in 'follow_up_policy.thread_message_template' (RemID: 2451cf2e-ace1-4a0b-854b-ec893bb26541)
08:35:00.699 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Prepended Slack mentions to main_text (RemID: 2451cf2e-ace1-4a0b-854b-ec893bb26541).
08:35:00.699 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Prepared task message for Slack with 'payload' dictionary (RemID: 2451cf2e-ace1-4a0b-854b-ec893bb26541).
08:35:00.699 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Publishing initial reminder task to list 'slack_message_send_queue' (RemID: 2451cf2e-ace1-4a0b-854b-ec893bb26541).
08:35:00.701 | DEBUG   | prefect.events.clients - Pinging to ensure websocket connected.
08:35:00.702 | DEBUG   | prefect.events.clients - Pong received. Websocket connected.
08:35:00.702 | DEBUG   | prefect.events.clients - Resending 0 unconfirmed events.
08:35:00.702 | DEBUG   | prefect.events.clients - Finished resending unconfirmed events.
08:35:00.702 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:35:00.703 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Successfully published initial reminder task to 'slack_message_send_queue' (RemID: 2451cf2e-ace1-4a0b-854b-ec893bb26541).
08:35:00.704 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Follow-up policy found. Recording state and scheduling next check (RemID: 2451cf2e-ace1-4a0b-854b-ec893bb26541).
08:35:00.704 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Saved initial state for 2451cf2e-ace1-4a0b-854b-ec893bb26541 to Redis hash 'reminder:state:2451cf2e-ace1-4a0b-854b-ec893bb26541'.
08:35:00.704 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Adding reminder 2451cf2e-ace1-4a0b-854b-ec893bb26541 to schedule ZSET 'reminder:followup_schedule' with score 1743640511 (2025-04-03T00:35:10.704354+00:00).
08:35:00.705 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Successfully added/updated 2451cf2e-ace1-4a0b-854b-ec893bb26541 in schedule ZSET (ZADD returned 1).
08:35:00.706 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-ee2' - Finished in state Completed()
08:35:00.707 | INFO    | Flow run 'hallowed-whale' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Reminder message successfully published.
08:35:00.707 | INFO    | Flow run 'hallowed-whale' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Sending to platform='line', destination='bacon_dm'
08:35:00.707 | INFO    | Flow run 'hallowed-whale' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Resolved mentions: ['Uccaf1be8b6335a9827558bfbec6769f1']
08:35:00.707 | INFO    | Flow run 'hallowed-whale' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Publishing reminder message task...
08:35:00.708 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-713' - Created task run 'Build, Publish Initial Reminder & Record State-713' for task 'Build, Publish Initial Reminder & Record State'
08:35:00.709 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-713' - Executing task 'Build, Publish Initial Reminder & Record State' for task run 'Build, Publish Initial Reminder & Record State-713'...
08:35:00.714 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emitting event id=89d95131-cadf-48aa-93ce-711bc9027920.
08:35:00.714 | DEBUG   | prefect.events.clients - Added event id=89d95131-cadf-48aa-93ce-711bc9027920 to unconfirmed events list. There are now 1 unconfirmed events.
08:35:00.714 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emit reconnection attempt 0.
08:35:00.714 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Sending event id=89d95131-cadf-48aa-93ce-711bc9027920.
08:35:00.715 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Checkpointing event id=89d95131-cadf-48aa-93ce-711bc9027920.
08:35:00.716 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emitting event id=ff196d85-975a-46e2-907f-08461cbc84ce.
08:35:00.716 | DEBUG   | prefect.events.clients - Added event id=ff196d85-975a-46e2-907f-08461cbc84ce to unconfirmed events list. There are now 2 unconfirmed events.
08:35:00.716 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emit reconnection attempt 0.
08:35:00.716 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Sending event id=ff196d85-975a-46e2-907f-08461cbc84ce.
08:35:00.716 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-713' - Task started: channel='line', template='LineReminderTemplate' (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a)
08:35:00.717 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-713' - Received context keys: ['destination_alias', 'mention_aliases', 'interaction_mode', 'main_text', 'follow_up_policy', 'mentions', 'recipient', 'sub_text', 'reminder_id']
08:35:00.717 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-713' - Processed placeholders in 'main_text' (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a)
08:35:00.717 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-713' - Processed placeholders in 'sub_text' (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a)
08:35:00.717 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Checkpointing event id=ff196d85-975a-46e2-907f-08461cbc84ce.
08:35:00.718 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-713' - Processed placeholders in 'follow_up_policy.thread_message_template' (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a)
08:35:00.719 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-713' - Payload: [FlexMessage(type='flex', quick_reply=None, sender=None, alt_text='Reminder: 早安 ☀️ 請點擊按鈕確認你醒著！', contents=FlexBubble(type='bubble', direction=None, styles=None, header=None, hero=None, body=FlexBox(type='box', layout='vertical', flex=None, contents=[FlexText(type='text', flex=None, text='@User1', size=None, align=None, gravity=None, color=None, weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='早安 ☀️ 請點擊按鈕確認你醒著！', size=None, align=None, gravity=None, color=None, weight='bold', style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='時間: 04/03 08:35', size='xs', align=None, gravity=None, color='#aaaaaa', weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None)], spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), footer=FlexBox(type='box', layout='vertical', flex=0, contents=[FlexButton(type='button', flex=None, color=None, style='primary', action=PostbackAction(type='postback', label='知道了', data='action=acknowledge&reminder_id=b5f697ac-5bec-4e71-a585-5c969d79430a', display_text=None, text=None, input_option=None, fill_in_text=None), gravity=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, height='sm', adjust_mode=None, scaling=None)], spacing='sm', margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), size=None, action=None))]
08:35:00.719 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-713' - Prepared task message for Line with 'payload_pickle' string (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a).
08:35:00.720 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-713' - Publishing initial reminder task to list 'line_push_message_queue' (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a).
08:35:00.720 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emitting event id=d317abf2-67d6-445a-a84b-ff340ce3dfb4.
08:35:00.721 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-713' - Successfully published initial reminder task to 'line_push_message_queue' (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a).
08:35:00.721 | DEBUG   | prefect.events.clients - Added event id=d317abf2-67d6-445a-a84b-ff340ce3dfb4 to unconfirmed events list. There are now 3 unconfirmed events.
08:35:00.721 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-713' - Follow-up policy found. Recording state and scheduling next check (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a).
08:35:00.721 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emit reconnection attempt 0.
08:35:00.722 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-713' - Saved initial state for b5f697ac-5bec-4e71-a585-5c969d79430a to Redis hash 'reminder:state:b5f697ac-5bec-4e71-a585-5c969d79430a'.
08:35:00.722 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Sending event id=d317abf2-67d6-445a-a84b-ff340ce3dfb4.
08:35:00.722 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-713' - Adding reminder b5f697ac-5bec-4e71-a585-5c969d79430a to schedule ZSET 'reminder:followup_schedule' with score 1743640511 (2025-04-03T00:35:10.721791+00:00).
08:35:00.722 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Checkpointing event id=d317abf2-67d6-445a-a84b-ff340ce3dfb4.
08:35:00.723 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-713' - Successfully added/updated b5f697ac-5bec-4e71-a585-5c969d79430a in schedule ZSET (ZADD returned 1).
08:35:00.723 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emitting event id=eb37ab37-ec0f-462a-bc8b-98a7ab4a1f6a.
08:35:00.724 | DEBUG   | prefect.events.clients - Added event id=eb37ab37-ec0f-462a-bc8b-98a7ab4a1f6a to unconfirmed events list. There are now 4 unconfirmed events.
08:35:00.724 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emit reconnection attempt 0.
08:35:00.724 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Sending event id=eb37ab37-ec0f-462a-bc8b-98a7ab4a1f6a.
08:35:00.725 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-713' - Finished in state Completed()
08:35:00.725 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Checkpointing event id=eb37ab37-ec0f-462a-bc8b-98a7ab4a1f6a.
08:35:00.725 | INFO    | Flow run 'hallowed-whale' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Reminder message successfully published.
08:35:00.726 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emitting event id=9cfae539-6abb-4d17-85e1-7858846f8136.
08:35:00.726 | DEBUG   | prefect.events.clients - Added event id=9cfae539-6abb-4d17-85e1-7858846f8136 to unconfirmed events list. There are now 5 unconfirmed events.
08:35:00.726 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emit reconnection attempt 0.
08:35:00.726 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Sending event id=9cfae539-6abb-4d17-85e1-7858846f8136.
08:35:00.726 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Checkpointing event id=9cfae539-6abb-4d17-85e1-7858846f8136.
08:35:00.727 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emitting event id=913aecad-babc-49ac-93cd-4fb454e46843.
08:35:00.728 | DEBUG   | prefect.events.clients - Added event id=913aecad-babc-49ac-93cd-4fb454e46843 to unconfirmed events list. There are now 6 unconfirmed events.
08:35:00.728 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Emit reconnection attempt 0.
08:35:00.728 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Sending event id=913aecad-babc-49ac-93cd-4fb454e46843.
08:35:00.728 | DEBUG   | prefect.events.clients - EventsClient(id=4938163120): Checkpointing event id=913aecad-babc-49ac-93cd-4fb454e46843.
08:35:00.751 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:35:00.751 | INFO    | Flow run 'hallowed-whale' - Finished in state Completed()
08:35:00.758 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103c857e0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106fbd0c0>>)
08:35:00.759 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:35:00.769 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:35:00.769 | INFO    | Flow run 'armored-malamute' - Finished in state Completed()
08:35:00.865 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:35:00.866 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:35:10.866286+00:00
08:35:00.876 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:35:01.002 | INFO    | prefect.flow_runs.runner - Process for flow run 'armored-malamute' exited cleanly.
08:35:07.994 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:35:08.019 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:35:09.009 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103c857e0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106fbd0c0>>)
08:35:09.011 | DEBUG   | prefect.runner - Runner has no active flow runs or deployments. Sending message to loop service that no further cancellation checks are needed.
08:35:09.013 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:35:09.020 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=926d0282-e19b-4115-84b4-53705d50cb19.
08:35:09.022 | DEBUG   | prefect.events.clients - Added event id=926d0282-e19b-4115-84b4-53705d50cb19 to unconfirmed events list. There are now 9 unconfirmed events.
08:35:09.022 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:35:09.023 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=926d0282-e19b-4115-84b4-53705d50cb19.
08:35:09.023 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=926d0282-e19b-4115-84b4-53705d50cb19.
08:35:12.915 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:35:12.916 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:35:22.916152+00:00
08:35:12.934 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:35:20.582 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:35:20.583 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:35:30.583605+00:00
08:35:20.595 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:35:30.559 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:35:30.560 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:35:40.560402+00:00
08:35:30.585 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:35:42.156 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:35:42.179 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:35:43.355 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:35:43.356 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:35:53.356765+00:00
08:35:43.373 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:35:54.488 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:35:54.488 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:36:04.488892+00:00
08:35:54.502 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:36:04.880 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:36:04.882 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:36:14.882863+00:00
08:36:04.900 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:36:15.239 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:36:15.265 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:36:17.656 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:36:17.657 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:36:27.657642+00:00
08:36:17.673 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:36:25.833 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:36:25.834 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:36:35.834284+00:00
08:36:25.856 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:36:37.714 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:36:37.716 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:36:47.716544+00:00
08:36:37.737 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:36:40.625 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:36:40.640 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:36:45.743 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:36:45.746 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:36:55.746304+00:00
08:36:45.774 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:36:56.785 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:36:56.790 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:37:06.790083+00:00
08:36:56.820 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:37:05.140 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:37:05.173 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:37:08.335 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:37:08.336 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:37:18.336637+00:00
08:37:08.354 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:37:20.895 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:37:20.900 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:37:30.900524+00:00
08:37:20.923 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:37:30.634 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:37:30.659 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:37:31.527 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:37:31.530 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:37:41.529209+00:00
08:37:31.549 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:37:40.663 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:37:40.665 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:37:50.665768+00:00
08:37:40.694 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:37:49.668 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:37:49.670 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:37:59.669917+00:00
08:37:49.689 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:37:57.736 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:37:57.737 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:38:07.737671+00:00
08:37:57.756 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:38:07.099 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:38:07.118 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:38:09.437 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:38:09.438 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:38:19.438736+00:00
08:38:09.461 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:38:17.286 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:38:17.287 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:38:27.287394+00:00
08:38:17.307 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:38:28.440 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:38:28.441 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:38:38.441540+00:00
08:38:28.459 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:38:30.715 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:38:30.732 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:38:36.205 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:38:36.206 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:38:46.206015+00:00
08:38:36.226 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:38:46.657 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:38:46.658 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:38:56.658250+00:00
08:38:46.673 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:38:59.432 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:38:59.433 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:39:09.433232+00:00
08:38:59.448 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:39:03.574 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:39:03.589 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:39:07.023 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:39:07.024 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:39:17.023955+00:00
08:39:07.037 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:39:17.316 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:39:17.317 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:39:27.317092+00:00
08:39:17.330 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:39:26.011 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:39:26.013 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:39:36.013603+00:00
08:39:26.028 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:39:31.436 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:39:31.468 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:39:35.768 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:39:35.770 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:39:45.769955+00:00
08:39:35.790 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:39:43.705 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:39:43.706 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:39:53.706421+00:00
08:39:43.733 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:39:56.135 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:39:56.138 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:40:06.138207+00:00
08:39:56.167 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 2 scheduled_flow_runs
08:39:56.168 | INFO    | prefect.flow_runs.worker - Worker 'ProcessWorker 853e55ce-760a-4c45-884f-563721ceeb78' submitting flow run 'e4e5bb69-fe33-4c9e-900a-8994b5189f81'
08:39:56.169 | INFO    | prefect.flow_runs.worker - Worker 'ProcessWorker 853e55ce-760a-4c45-884f-563721ceeb78' submitting flow run '3397e332-ae6c-4088-ad81-809d6dfe29e6'
08:39:56.219 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Ready to submit e4e5bb69-fe33-4c9e-900a-8994b5189f81: True
08:39:56.236 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=ce292b07-20ab-4efb-a82c-4e51667fa918.
08:39:56.237 | DEBUG   | prefect.events.clients - Added event id=ce292b07-20ab-4efb-a82c-4e51667fa918 to unconfirmed events list. There are now 10 unconfirmed events.
08:39:56.237 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:39:56.237 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=ce292b07-20ab-4efb-a82c-4e51667fa918.
08:39:56.237 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=ce292b07-20ab-4efb-a82c-4e51667fa918.
08:39:56.249 | DEBUG   | prefect.client - Received response with retryable status code 503. Another attempt will be made in 1.6923941727419172s. This is attempt 1/6.
08:39:56.268 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Ready to submit 3397e332-ae6c-4088-ad81-809d6dfe29e6: True
08:39:56.283 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=07af4c7f-1d38-45a2-b1be-08f1852f6056.
08:39:56.283 | DEBUG   | prefect.events.clients - Added event id=07af4c7f-1d38-45a2-b1be-08f1852f6056 to unconfirmed events list. There are now 11 unconfirmed events.
08:39:56.283 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:39:56.284 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=07af4c7f-1d38-45a2-b1be-08f1852f6056.
08:39:56.284 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=07af4c7f-1d38-45a2-b1be-08f1852f6056.
08:39:56.297 | INFO    | prefect.flow_runs.runner - Opening process...
08:39:56.309 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103f4e8c0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106d51e10>>)
08:39:56.309 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:39:56.314 | INFO    | prefect.flow_runs.worker - Completed submission of flow run '3397e332-ae6c-4088-ad81-809d6dfe29e6'
08:39:57.970 | INFO    | prefect.flow_runs.runner - Opening process...
08:39:57.986 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103f4cc10>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x107003100>>)
08:39:57.987 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:39:57.993 | INFO    | prefect.flow_runs.worker - Completed submission of flow run 'e4e5bb69-fe33-4c9e-900a-8994b5189f81'
08:40:00.615 | DEBUG   | prefect.profiles - Using profile 'uat'
08:40:00.615 | DEBUG   | prefect.profiles - Using profile 'uat'
08:40:01.312 | DEBUG   | Flow run 'military-swallow' - Running 1 deployment pull step(s)
08:40:01.312 | DEBUG   | Flow run 'spirited-pig' - Running 1 deployment pull step(s)
08:40:01.331 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:01.331 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:01.382 | INFO    | Flow run 'spirited-pig' -  > Running set_working_directory step...
08:40:01.382 | INFO    | Flow run 'military-swallow' -  > Running set_working_directory step...
08:40:01.395 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:01.395 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:01.406 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:01.406 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:01.408 | DEBUG   | Flow run 'military-swallow' - Changing working directory to '/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/'
08:40:01.408 | DEBUG   | Flow run 'spirited-pig' - Changing working directory to '/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/'
08:40:01.409 | DEBUG   | Flow run 'spirited-pig' - Importing flow code from 'orch/flows/scheduled/launch_due_reminder_checks_flow.py:launch_due_reminder_checks_flow'
08:40:01.409 | DEBUG   | Flow run 'military-swallow' - Importing flow code from 'orch/flows/scheduled/send_morning_reminder_flow.py:send_morning_reminder_flow'
08:40:02.485 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:40:02.509 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:40:04.153 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:04.189 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:40:04.189 | INFO    | Flow run 'spirited-pig' - Beginning flow run 'spirited-pig' for flow 'Example - Send Reminder Message'
08:40:04.190 | INFO    | Flow run 'spirited-pig' - View at http://0.0.0.0:4201/runs/flow-run/e4e5bb69-fe33-4c9e-900a-8994b5189f81
08:40:04.190 | DEBUG   | Flow run 'spirited-pig' - Executing flow 'Example - Send Reminder Message' for flow run 'spirited-pig'...
08:40:04.194 | INFO    | Flow run 'spirited-pig' - Found 6 due reminder(s). Launching follow-up flows...
08:40:04.209 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:40:04.210 | INFO    | Flow run 'military-swallow' - Beginning flow run 'military-swallow' for flow 'Scheduled - Morning Wake Up Reminder'
08:40:04.211 | INFO    | Flow run 'military-swallow' - View at http://0.0.0.0:4201/runs/flow-run/3397e332-ae6c-4088-ad81-809d6dfe29e6
08:40:04.211 | DEBUG   | Flow run 'military-swallow' - Executing flow 'Scheduled - Morning Wake Up Reminder' for flow run 'military-swallow'...
08:40:04.213 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103f4e8c0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106d51e10>>)
08:40:04.213 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:40:04.302 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:04.691 | DEBUG   | prefect.client - Received response with retryable status code 503. Another attempt will be made in 2.3713416529599582s. This is attempt 1/6.
08:40:04.755 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:40:04.755 | INFO    | Flow run 'lively-grouse' - Beginning subflow run 'lively-grouse' for flow 'Send Follow-up Reminder'
08:40:04.756 | INFO    | Flow run 'lively-grouse' - View at http://0.0.0.0:4201/runs/flow-run/05ebf985-937f-4e90-8a42-ca148985bf51
08:40:04.756 | DEBUG   | Flow run 'lively-grouse' - Executing flow 'Send Follow-up Reminder' for flow run 'lively-grouse'...
08:40:04.756 | INFO    | Flow run 'lively-grouse' - Starting follow-up flow for reminder_id: 16acf62a-39db-478f-a7a0-1b944861466c
08:40:04.798 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:40:04.799 | INFO    | Flow run 'lively-grouse' - Finished in state Completed()
08:40:04.805 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:04.816 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-238' - Created task run 'Build and Publish Follow-up Reminder Message-238' for task 'Build and Publish Follow-up Reminder Message'
08:40:04.817 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-238' - Executing task 'Build and Publish Follow-up Reminder Message' for task run 'Build and Publish Follow-up Reminder Message-238'...
08:40:04.825 | DEBUG   | prefect.events.clients - Reconnecting websocket connection.
08:40:04.825 | DEBUG   | prefect.events.clients - Opening websocket connection.
08:40:04.828 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-238' - [FollowUp:16acf62a] Fetching reminder state from Redis
08:40:04.828 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-238' - [FollowUp:16acf62a] Payload built: {'type': 'reminder_followup', 'text': '<@U08J619BW3B> Good morning!. 尚未處理！', 'sub_text': "Please click the button to confirm you're alive.\n時間: 04/03 08:28", 'thread_ts': '1743640202.143269'}
08:40:04.829 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-238' - [FollowUp:16acf62a] Follow-up reminder enqueued to slack_message_send_queue.
08:40:04.830 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-238' - Finished in state Completed()
08:40:04.831 | INFO    | Flow run 'spirited-pig' - Triggered follow-up flow for reminder 16acf62a-39db-478f-a7a0-1b944861466c.
08:40:04.832 | DEBUG   | prefect.events.clients - Pinging to ensure websocket connected.
08:40:04.832 | DEBUG   | prefect.events.clients - Pong received. Websocket connected.
08:40:04.832 | DEBUG   | prefect.events.clients - Resending 0 unconfirmed events.
08:40:04.833 | DEBUG   | prefect.events.clients - Finished resending unconfirmed events.
08:40:04.833 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:04.838 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:04.856 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=b9509129-473e-4459-825c-457392acb8f9.
08:40:04.857 | DEBUG   | prefect.events.clients - Added event id=b9509129-473e-4459-825c-457392acb8f9 to unconfirmed events list. There are now 1 unconfirmed events.
08:40:04.857 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:04.857 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=b9509129-473e-4459-825c-457392acb8f9.
08:40:04.857 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=b9509129-473e-4459-825c-457392acb8f9.
08:40:04.858 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=8fec6c78-a6f2-4d1b-8c3c-8921b0135948.
08:40:04.858 | DEBUG   | prefect.events.clients - Added event id=8fec6c78-a6f2-4d1b-8c3c-8921b0135948 to unconfirmed events list. There are now 2 unconfirmed events.
08:40:04.858 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:04.858 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=8fec6c78-a6f2-4d1b-8c3c-8921b0135948.
08:40:04.858 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=8fec6c78-a6f2-4d1b-8c3c-8921b0135948.
08:40:04.859 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=8a9f5b40-5c04-4d2e-a1ac-99c7ce90c5f8.
08:40:04.859 | DEBUG   | prefect.events.clients - Added event id=8a9f5b40-5c04-4d2e-a1ac-99c7ce90c5f8 to unconfirmed events list. There are now 3 unconfirmed events.
08:40:04.859 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:04.859 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=8a9f5b40-5c04-4d2e-a1ac-99c7ce90c5f8.
08:40:04.859 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=8a9f5b40-5c04-4d2e-a1ac-99c7ce90c5f8.
08:40:04.884 | DEBUG   | prefect.client - Received response with retryable status code 503. Another attempt will be made in 2.139695490379106s. This is attempt 1/6.
08:40:07.099 | INFO    | prefect.engine - View at http://0.0.0.0:4201/runs/flow-run/21755046-5990-40b1-91ae-3afb9eb3fd56
08:40:07.143 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:40:07.144 | INFO    | Flow run 'elite-bear' - Beginning subflow run 'elite-bear' for flow 'Send Reminder Message Flow'
08:40:07.144 | INFO    | Flow run 'elite-bear' - View at http://0.0.0.0:4201/runs/flow-run/21755046-5990-40b1-91ae-3afb9eb3fd56
08:40:07.145 | DEBUG   | Flow run 'elite-bear' - Executing flow 'Send Reminder Message Flow' for flow run 'elite-bear'...
08:40:07.145 | INFO    | Flow run 'elite-bear' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Sending to platform='slack', destination='uat_channel'
08:40:07.145 | INFO    | Flow run 'elite-bear' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Resolved mentions: ['U08J619BW3B']
08:40:07.146 | INFO    | Flow run 'elite-bear' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Publishing reminder message task...
08:40:07.146 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:40:07.148 | INFO    | Flow run 'quixotic-chameleon' - Beginning subflow run 'quixotic-chameleon' for flow 'Send Follow-up Reminder'
08:40:07.148 | INFO    | Flow run 'quixotic-chameleon' - View at http://0.0.0.0:4201/runs/flow-run/27cb17c2-6187-412f-8a2a-0bbe55c2e133
08:40:07.148 | DEBUG   | Flow run 'quixotic-chameleon' - Executing flow 'Send Follow-up Reminder' for flow run 'quixotic-chameleon'...
08:40:07.149 | INFO    | Flow run 'quixotic-chameleon' - Starting follow-up flow for reminder_id: d1a44283-1c92-44d0-bea4-7ece3da83762
08:40:07.158 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-216' - Created task run 'Build, Publish Initial Reminder & Record State-216' for task 'Build, Publish Initial Reminder & Record State'
08:40:07.159 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-216' - Executing task 'Build, Publish Initial Reminder & Record State' for task run 'Build, Publish Initial Reminder & Record State-216'...
08:40:07.165 | DEBUG   | prefect.events.clients - Reconnecting websocket connection.
08:40:07.165 | DEBUG   | prefect.events.clients - Opening websocket connection.
08:40:07.166 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-216' - Task started: channel='slack', template='SlackReminderTemplate' (RemID: d09a3b96-bbec-47ba-8fe8-2eddc1af74d8)
08:40:07.166 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-216' - Received context keys: ['destination_alias', 'mention_aliases', 'interaction_mode', 'main_text', 'sub_text', 'follow_up_policy', 'mentions', 'recipient', 'reminder_id']
08:40:07.166 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-216' - Processed placeholders in 'main_text' (RemID: d09a3b96-bbec-47ba-8fe8-2eddc1af74d8)
08:40:07.166 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-216' - Processed placeholders in 'sub_text' (RemID: d09a3b96-bbec-47ba-8fe8-2eddc1af74d8)
08:40:07.167 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-216' - Processed placeholders in 'follow_up_policy.thread_message_template' (RemID: d09a3b96-bbec-47ba-8fe8-2eddc1af74d8)
08:40:07.167 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-216' - Prepended Slack mentions to main_text (RemID: d09a3b96-bbec-47ba-8fe8-2eddc1af74d8).
08:40:07.167 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-216' - Prepared task message for Slack with 'payload' dictionary (RemID: d09a3b96-bbec-47ba-8fe8-2eddc1af74d8).
08:40:07.168 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-216' - Publishing initial reminder task to list 'slack_message_send_queue' (RemID: d09a3b96-bbec-47ba-8fe8-2eddc1af74d8).
08:40:07.170 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:40:07.170 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-216' - Successfully published initial reminder task to 'slack_message_send_queue' (RemID: d09a3b96-bbec-47ba-8fe8-2eddc1af74d8).
08:40:07.170 | INFO    | Flow run 'quixotic-chameleon' - Finished in state Completed()
08:40:07.171 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-216' - Follow-up policy found. Recording state and scheduling next check (RemID: d09a3b96-bbec-47ba-8fe8-2eddc1af74d8).
08:40:07.171 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-216' - Saved initial state for d09a3b96-bbec-47ba-8fe8-2eddc1af74d8 to Redis hash 'reminder:state:d09a3b96-bbec-47ba-8fe8-2eddc1af74d8'.
08:40:07.172 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-216' - Adding reminder d09a3b96-bbec-47ba-8fe8-2eddc1af74d8 to schedule ZSET 'reminder:followup_schedule' with score 1743640817 (2025-04-03T00:40:17.171639+00:00).
08:40:07.172 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-216' - Successfully added/updated d09a3b96-bbec-47ba-8fe8-2eddc1af74d8 in schedule ZSET (ZADD returned 1).
08:40:07.173 | DEBUG   | prefect.events.clients - Pinging to ensure websocket connected.
08:40:07.173 | DEBUG   | prefect.events.clients - Pong received. Websocket connected.
08:40:07.173 | DEBUG   | prefect.events.clients - Resending 0 unconfirmed events.
08:40:07.174 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-216' - Finished in state Completed()
08:40:07.174 | DEBUG   | prefect.events.clients - Finished resending unconfirmed events.
08:40:07.174 | INFO    | Flow run 'elite-bear' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Reminder message successfully published.
08:40:07.175 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:07.175 | INFO    | Flow run 'elite-bear' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Sending to platform='line', destination='bacon_dm'
08:40:07.175 | INFO    | Flow run 'elite-bear' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Resolved mentions: ['Uccaf1be8b6335a9827558bfbec6769f1']
08:40:07.176 | INFO    | Flow run 'elite-bear' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Publishing reminder message task...
08:40:07.176 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-c97' - Created task run 'Build, Publish Initial Reminder & Record State-c97' for task 'Build, Publish Initial Reminder & Record State'
08:40:07.177 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-c97' - Executing task 'Build, Publish Initial Reminder & Record State' for task run 'Build, Publish Initial Reminder & Record State-c97'...
08:40:07.177 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:07.183 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-c97' - Task started: channel='line', template='LineReminderTemplate' (RemID: 93e2610b-8714-443d-8461-abd2fdb3d056)
08:40:07.183 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-c97' - Received context keys: ['destination_alias', 'mention_aliases', 'interaction_mode', 'main_text', 'follow_up_policy', 'mentions', 'recipient', 'sub_text', 'reminder_id']
08:40:07.183 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-c97' - Processed placeholders in 'main_text' (RemID: 93e2610b-8714-443d-8461-abd2fdb3d056)
08:40:07.184 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-c97' - Processed placeholders in 'sub_text' (RemID: 93e2610b-8714-443d-8461-abd2fdb3d056)
08:40:07.184 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-c97' - Processed placeholders in 'follow_up_policy.thread_message_template' (RemID: 93e2610b-8714-443d-8461-abd2fdb3d056)
08:40:07.184 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-e6c' - Created task run 'Build and Publish Follow-up Reminder Message-e6c' for task 'Build and Publish Follow-up Reminder Message'
08:40:07.185 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-e6c' - Executing task 'Build and Publish Follow-up Reminder Message' for task run 'Build and Publish Follow-up Reminder Message-e6c'...
08:40:07.185 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-c97' - Payload: [FlexMessage(type='flex', quick_reply=None, sender=None, alt_text='Reminder: 早安 ☀️ 請點擊按鈕確認你醒著！', contents=FlexBubble(type='bubble', direction=None, styles=None, header=None, hero=None, body=FlexBox(type='box', layout='vertical', flex=None, contents=[FlexText(type='text', flex=None, text='@User1', size=None, align=None, gravity=None, color=None, weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='早安 ☀️ 請點擊按鈕確認你醒著！', size=None, align=None, gravity=None, color=None, weight='bold', style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='時間: 04/03 08:40', size='xs', align=None, gravity=None, color='#aaaaaa', weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None)], spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), footer=FlexBox(type='box', layout='vertical', flex=0, contents=[FlexButton(type='button', flex=None, color=None, style='primary', action=PostbackAction(type='postback', label='知道了', data='action=acknowledge&reminder_id=93e2610b-8714-443d-8461-abd2fdb3d056', display_text=None, text=None, input_option=None, fill_in_text=None), gravity=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, height='sm', adjust_mode=None, scaling=None)], spacing='sm', margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), size=None, action=None))]
08:40:07.186 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-c97' - Prepared task message for Line with 'payload_pickle' string (RemID: 93e2610b-8714-443d-8461-abd2fdb3d056).
08:40:07.186 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-c97' - Publishing initial reminder task to list 'line_push_message_queue' (RemID: 93e2610b-8714-443d-8461-abd2fdb3d056).
08:40:07.187 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-c97' - Successfully published initial reminder task to 'line_push_message_queue' (RemID: 93e2610b-8714-443d-8461-abd2fdb3d056).
08:40:07.187 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-c97' - Follow-up policy found. Recording state and scheduling next check (RemID: 93e2610b-8714-443d-8461-abd2fdb3d056).
08:40:07.187 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-c97' - Saved initial state for 93e2610b-8714-443d-8461-abd2fdb3d056 to Redis hash 'reminder:state:93e2610b-8714-443d-8461-abd2fdb3d056'.
08:40:07.188 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=2f085145-688c-4889-a602-6654d7f678a1.
08:40:07.188 | DEBUG   | prefect.events.clients - Added event id=2f085145-688c-4889-a602-6654d7f678a1 to unconfirmed events list. There are now 4 unconfirmed events.
08:40:07.188 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-c97' - Adding reminder 93e2610b-8714-443d-8461-abd2fdb3d056 to schedule ZSET 'reminder:followup_schedule' with score 1743640817 (2025-04-03T00:40:17.187568+00:00).
08:40:07.188 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:07.188 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-c97' - Successfully added/updated 93e2610b-8714-443d-8461-abd2fdb3d056 in schedule ZSET (ZADD returned 1).
08:40:07.188 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=2f085145-688c-4889-a602-6654d7f678a1.
08:40:07.189 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=2f085145-688c-4889-a602-6654d7f678a1.
08:40:07.189 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-c97' - Finished in state Completed()
08:40:07.189 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-e6c' - [FollowUp:d1a44283] Fetching reminder state from Redis
08:40:07.190 | INFO    | Flow run 'elite-bear' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Reminder message successfully published.
08:40:07.190 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-e6c' - [FollowUp:d1a44283] Payload built: [TextMessage(type='text', quick_reply=None, sender=None, text='報告 [N/A] 還沒好嗎？', emojis=None, quote_token=None)]
08:40:07.191 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-e6c' - [FollowUp:d1a44283] Follow-up reminder enqueued to line_push_message_queue.
08:40:07.191 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=5477314b-35aa-4e30-954f-e8cc79ea71eb.
08:40:07.191 | DEBUG   | prefect.events.clients - Added event id=5477314b-35aa-4e30-954f-e8cc79ea71eb to unconfirmed events list. There are now 5 unconfirmed events.
08:40:07.191 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:07.192 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=5477314b-35aa-4e30-954f-e8cc79ea71eb.
08:40:07.192 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-e6c' - Finished in state Completed()
08:40:07.193 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=5477314b-35aa-4e30-954f-e8cc79ea71eb.
08:40:07.193 | INFO    | Flow run 'spirited-pig' - Triggered follow-up flow for reminder d1a44283-1c92-44d0-bea4-7ece3da83762.
08:40:07.194 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=caa6ddb0-545e-4e69-9e33-e1266a7a717f.
08:40:07.194 | DEBUG   | prefect.events.clients - Added event id=caa6ddb0-545e-4e69-9e33-e1266a7a717f to unconfirmed events list. There are now 6 unconfirmed events.
08:40:07.195 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:07.195 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=caa6ddb0-545e-4e69-9e33-e1266a7a717f.
08:40:07.195 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=caa6ddb0-545e-4e69-9e33-e1266a7a717f.
08:40:07.201 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:07.201 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emitting event id=bbcfed38-9214-41ff-9022-b5f28ac490ed.
08:40:07.202 | DEBUG   | prefect.events.clients - Added event id=bbcfed38-9214-41ff-9022-b5f28ac490ed to unconfirmed events list. There are now 1 unconfirmed events.
08:40:07.202 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emit reconnection attempt 0.
08:40:07.202 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Sending event id=bbcfed38-9214-41ff-9022-b5f28ac490ed.
08:40:07.202 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Checkpointing event id=bbcfed38-9214-41ff-9022-b5f28ac490ed.
08:40:07.203 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emitting event id=662caa9e-58bc-4e41-aef9-610055f388e3.
08:40:07.203 | DEBUG   | prefect.events.clients - Added event id=662caa9e-58bc-4e41-aef9-610055f388e3 to unconfirmed events list. There are now 2 unconfirmed events.
08:40:07.203 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emit reconnection attempt 0.
08:40:07.203 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Sending event id=662caa9e-58bc-4e41-aef9-610055f388e3.
08:40:07.203 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Checkpointing event id=662caa9e-58bc-4e41-aef9-610055f388e3.
08:40:07.204 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emitting event id=0bcc0096-cbb0-41d0-8f38-2f81d6bc028f.
08:40:07.204 | DEBUG   | prefect.events.clients - Added event id=0bcc0096-cbb0-41d0-8f38-2f81d6bc028f to unconfirmed events list. There are now 3 unconfirmed events.
08:40:07.204 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emit reconnection attempt 0.
08:40:07.204 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Sending event id=0bcc0096-cbb0-41d0-8f38-2f81d6bc028f.
08:40:07.204 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Checkpointing event id=0bcc0096-cbb0-41d0-8f38-2f81d6bc028f.
08:40:07.205 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emitting event id=7757db24-3620-4365-9155-170245ce5241.
08:40:07.205 | DEBUG   | prefect.events.clients - Added event id=7757db24-3620-4365-9155-170245ce5241 to unconfirmed events list. There are now 4 unconfirmed events.
08:40:07.205 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emit reconnection attempt 0.
08:40:07.205 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Sending event id=7757db24-3620-4365-9155-170245ce5241.
08:40:07.205 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Checkpointing event id=7757db24-3620-4365-9155-170245ce5241.
08:40:07.206 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emitting event id=edaf8145-3911-447b-81f2-59dad7d808ff.
08:40:07.206 | DEBUG   | prefect.events.clients - Added event id=edaf8145-3911-447b-81f2-59dad7d808ff to unconfirmed events list. There are now 5 unconfirmed events.
08:40:07.206 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emit reconnection attempt 0.
08:40:07.206 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Sending event id=edaf8145-3911-447b-81f2-59dad7d808ff.
08:40:07.207 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Checkpointing event id=edaf8145-3911-447b-81f2-59dad7d808ff.
08:40:07.207 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emitting event id=b1efd926-2978-4d0d-8030-ba111a9d0fbd.
08:40:07.207 | DEBUG   | prefect.events.clients - Added event id=b1efd926-2978-4d0d-8030-ba111a9d0fbd to unconfirmed events list. There are now 6 unconfirmed events.
08:40:07.207 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Emit reconnection attempt 0.
08:40:07.207 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Sending event id=b1efd926-2978-4d0d-8030-ba111a9d0fbd.
08:40:07.208 | DEBUG   | prefect.events.clients - EventsClient(id=4605022640): Checkpointing event id=b1efd926-2978-4d0d-8030-ba111a9d0fbd.
08:40:07.231 | DEBUG   | prefect.client - Received response with retryable status code 503. Another attempt will be made in 1.9521317802700167s. This is attempt 1/6.
08:40:07.256 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:40:07.256 | INFO    | Flow run 'elite-bear' - Finished in state Completed()
08:40:07.274 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:40:07.274 | INFO    | Flow run 'military-swallow' - Finished in state Completed()
08:40:07.486 | INFO    | prefect.flow_runs.runner - Process for flow run 'military-swallow' exited cleanly.
08:40:07.568 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:40:07.569 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:40:17.569253+00:00
08:40:07.581 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:40:08.323 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103f4cc10>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x107003100>>)
08:40:08.324 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:40:09.264 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:40:09.265 | INFO    | Flow run 'heavy-poodle' - Beginning subflow run 'heavy-poodle' for flow 'Send Follow-up Reminder'
08:40:09.266 | INFO    | Flow run 'heavy-poodle' - View at http://0.0.0.0:4201/runs/flow-run/e94a77a8-1731-47f5-ab5d-58664d5fce24
08:40:09.266 | DEBUG   | Flow run 'heavy-poodle' - Executing flow 'Send Follow-up Reminder' for flow run 'heavy-poodle'...
08:40:09.266 | INFO    | Flow run 'heavy-poodle' - Starting follow-up flow for reminder_id: a03cf709-854b-429d-91ee-a4b52bf38685
08:40:09.283 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:40:09.283 | INFO    | Flow run 'heavy-poodle' - Finished in state Completed()
08:40:09.289 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:09.294 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-254' - Created task run 'Build and Publish Follow-up Reminder Message-254' for task 'Build and Publish Follow-up Reminder Message'
08:40:09.295 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-254' - Executing task 'Build and Publish Follow-up Reminder Message' for task run 'Build and Publish Follow-up Reminder Message-254'...
08:40:09.297 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=01b59563-fbec-4dbb-8540-0ed12297a97f.
08:40:09.297 | DEBUG   | prefect.events.clients - Added event id=01b59563-fbec-4dbb-8540-0ed12297a97f to unconfirmed events list. There are now 7 unconfirmed events.
08:40:09.297 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.298 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=01b59563-fbec-4dbb-8540-0ed12297a97f.
08:40:09.298 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=01b59563-fbec-4dbb-8540-0ed12297a97f.
08:40:09.299 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-254' - [FollowUp:a03cf709] Fetching reminder state from Redis
08:40:09.299 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=c8d6a7ad-8e28-4788-85f0-f46eb49ec315.
08:40:09.299 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-254' - [FollowUp:a03cf709] Payload built: {'type': 'reminder_followup', 'text': '<@U08J619BW3B> Good morning!. 尚未處理！', 'sub_text': "Please click the button to confirm you're alive.\n時間: 04/03 08:30", 'thread_ts': '1743640200.579189'}
08:40:09.300 | DEBUG   | prefect.events.clients - Added event id=c8d6a7ad-8e28-4788-85f0-f46eb49ec315 to unconfirmed events list. There are now 8 unconfirmed events.
08:40:09.300 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.300 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=c8d6a7ad-8e28-4788-85f0-f46eb49ec315.
08:40:09.301 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-254' - [FollowUp:a03cf709] Follow-up reminder enqueued to slack_message_send_queue.
08:40:09.301 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=c8d6a7ad-8e28-4788-85f0-f46eb49ec315.
08:40:09.302 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-254' - Finished in state Completed()
08:40:09.303 | INFO    | Flow run 'spirited-pig' - Triggered follow-up flow for reminder a03cf709-854b-429d-91ee-a4b52bf38685.
08:40:09.303 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=9d9017cc-2434-49cf-9129-19ddbd5c17ba.
08:40:09.303 | DEBUG   | prefect.events.clients - Added event id=9d9017cc-2434-49cf-9129-19ddbd5c17ba to unconfirmed events list. There are now 9 unconfirmed events.
08:40:09.304 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.304 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=9d9017cc-2434-49cf-9129-19ddbd5c17ba.
08:40:09.304 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=9d9017cc-2434-49cf-9129-19ddbd5c17ba.
08:40:09.311 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:09.386 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:40:09.387 | INFO    | Flow run 'annoying-quetzal' - Beginning subflow run 'annoying-quetzal' for flow 'Send Follow-up Reminder'
08:40:09.387 | INFO    | Flow run 'annoying-quetzal' - View at http://0.0.0.0:4201/runs/flow-run/eb5bebee-7480-46df-a6cb-d347163658ff
08:40:09.388 | DEBUG   | Flow run 'annoying-quetzal' - Executing flow 'Send Follow-up Reminder' for flow run 'annoying-quetzal'...
08:40:09.388 | INFO    | Flow run 'annoying-quetzal' - Starting follow-up flow for reminder_id: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04
08:40:09.407 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:40:09.408 | INFO    | Flow run 'annoying-quetzal' - Finished in state Completed()
08:40:09.414 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:09.420 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-d56' - Created task run 'Build and Publish Follow-up Reminder Message-d56' for task 'Build and Publish Follow-up Reminder Message'
08:40:09.421 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-d56' - Executing task 'Build and Publish Follow-up Reminder Message' for task run 'Build and Publish Follow-up Reminder Message-d56'...
08:40:09.423 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=054c8b20-1923-4553-b927-974f119a2db5.
08:40:09.423 | DEBUG   | prefect.events.clients - Added event id=054c8b20-1923-4553-b927-974f119a2db5 to unconfirmed events list. There are now 10 unconfirmed events.
08:40:09.424 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.424 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=054c8b20-1923-4553-b927-974f119a2db5.
08:40:09.424 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=054c8b20-1923-4553-b927-974f119a2db5.
08:40:09.425 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=624917c5-9bdb-45c1-b162-c5aa0e430604.
08:40:09.425 | DEBUG   | prefect.events.clients - Added event id=624917c5-9bdb-45c1-b162-c5aa0e430604 to unconfirmed events list. There are now 11 unconfirmed events.
08:40:09.425 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-d56' - [FollowUp:73e5ef18] Fetching reminder state from Redis
08:40:09.425 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.426 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=624917c5-9bdb-45c1-b162-c5aa0e430604.
08:40:09.426 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-d56' - [FollowUp:73e5ef18] Payload built: [TextMessage(type='text', quick_reply=None, sender=None, text='報告 [N/A] 還沒好嗎？', emojis=None, quote_token=None)]
08:40:09.427 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=624917c5-9bdb-45c1-b162-c5aa0e430604.
08:40:09.427 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-d56' - [FollowUp:73e5ef18] Follow-up reminder enqueued to line_push_message_queue.
08:40:09.428 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-d56' - Finished in state Completed()
08:40:09.429 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=b3dc9b92-630d-4c4d-b137-c56954a899aa.
08:40:09.429 | INFO    | Flow run 'spirited-pig' - Triggered follow-up flow for reminder 73e5ef18-5ec0-42aa-8fe0-8167e14abb04.
08:40:09.429 | DEBUG   | prefect.events.clients - Added event id=b3dc9b92-630d-4c4d-b137-c56954a899aa to unconfirmed events list. There are now 12 unconfirmed events.
08:40:09.430 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.430 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=b3dc9b92-630d-4c4d-b137-c56954a899aa.
08:40:09.430 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=b3dc9b92-630d-4c4d-b137-c56954a899aa.
08:40:09.437 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:09.496 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:40:09.497 | INFO    | Flow run 'loose-mouflon' - Beginning subflow run 'loose-mouflon' for flow 'Send Follow-up Reminder'
08:40:09.498 | INFO    | Flow run 'loose-mouflon' - View at http://0.0.0.0:4201/runs/flow-run/34ff25ab-691d-4a7b-8694-5dc706243d79
08:40:09.499 | DEBUG   | Flow run 'loose-mouflon' - Executing flow 'Send Follow-up Reminder' for flow run 'loose-mouflon'...
08:40:09.499 | INFO    | Flow run 'loose-mouflon' - Starting follow-up flow for reminder_id: 2451cf2e-ace1-4a0b-854b-ec893bb26541
08:40:09.516 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:40:09.516 | INFO    | Flow run 'loose-mouflon' - Finished in state Completed()
08:40:09.523 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:09.528 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-f89' - Created task run 'Build and Publish Follow-up Reminder Message-f89' for task 'Build and Publish Follow-up Reminder Message'
08:40:09.529 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-f89' - Executing task 'Build and Publish Follow-up Reminder Message' for task run 'Build and Publish Follow-up Reminder Message-f89'...
08:40:09.531 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=1fe7ea1d-30ac-4857-9a47-6d537cb6f31e.
08:40:09.531 | DEBUG   | prefect.events.clients - Added event id=1fe7ea1d-30ac-4857-9a47-6d537cb6f31e to unconfirmed events list. There are now 13 unconfirmed events.
08:40:09.531 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.532 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=1fe7ea1d-30ac-4857-9a47-6d537cb6f31e.
08:40:09.532 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=1fe7ea1d-30ac-4857-9a47-6d537cb6f31e.
08:40:09.533 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=de4f9686-912e-455e-91a5-8a2f6cce1b25.
08:40:09.533 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-f89' - [FollowUp:2451cf2e] Fetching reminder state from Redis
08:40:09.533 | DEBUG   | prefect.events.clients - Added event id=de4f9686-912e-455e-91a5-8a2f6cce1b25 to unconfirmed events list. There are now 14 unconfirmed events.
08:40:09.534 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.534 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=de4f9686-912e-455e-91a5-8a2f6cce1b25.
08:40:09.534 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-f89' - [FollowUp:2451cf2e] Payload built: {'type': 'reminder_followup', 'text': '<@U08J619BW3B> Good morning!. 尚未處理！', 'sub_text': "Please click the button to confirm you're alive.\n時間: 04/03 08:35", 'thread_ts': '1743640501.089109'}
08:40:09.535 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=de4f9686-912e-455e-91a5-8a2f6cce1b25.
08:40:09.535 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-f89' - [FollowUp:2451cf2e] Follow-up reminder enqueued to slack_message_send_queue.
08:40:09.536 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-f89' - Finished in state Completed()
08:40:09.537 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=72cab01b-86b4-49c7-bb30-feca30c9485e.
08:40:09.537 | DEBUG   | prefect.events.clients - Added event id=72cab01b-86b4-49c7-bb30-feca30c9485e to unconfirmed events list. There are now 15 unconfirmed events.
08:40:09.537 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.537 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=72cab01b-86b4-49c7-bb30-feca30c9485e.
08:40:09.537 | INFO    | Flow run 'spirited-pig' - Triggered follow-up flow for reminder 2451cf2e-ace1-4a0b-854b-ec893bb26541.
08:40:09.538 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=72cab01b-86b4-49c7-bb30-feca30c9485e.
08:40:09.544 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:09.626 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:40:09.627 | INFO    | Flow run 'amiable-cormorant' - Beginning subflow run 'amiable-cormorant' for flow 'Send Follow-up Reminder'
08:40:09.627 | INFO    | Flow run 'amiable-cormorant' - View at http://0.0.0.0:4201/runs/flow-run/4eed16ad-8f5c-4459-a459-17bb612e93a4
08:40:09.628 | DEBUG   | Flow run 'amiable-cormorant' - Executing flow 'Send Follow-up Reminder' for flow run 'amiable-cormorant'...
08:40:09.628 | INFO    | Flow run 'amiable-cormorant' - Starting follow-up flow for reminder_id: b5f697ac-5bec-4e71-a585-5c969d79430a
08:40:09.648 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:40:09.648 | INFO    | Flow run 'amiable-cormorant' - Finished in state Completed()
08:40:09.655 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:40:09.661 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-b25' - Created task run 'Build and Publish Follow-up Reminder Message-b25' for task 'Build and Publish Follow-up Reminder Message'
08:40:09.662 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-b25' - Executing task 'Build and Publish Follow-up Reminder Message' for task run 'Build and Publish Follow-up Reminder Message-b25'...
08:40:09.664 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=75e9201a-fec6-4d66-a25c-2e590b2235cf.
08:40:09.664 | DEBUG   | prefect.events.clients - Added event id=75e9201a-fec6-4d66-a25c-2e590b2235cf to unconfirmed events list. There are now 16 unconfirmed events.
08:40:09.664 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.665 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=75e9201a-fec6-4d66-a25c-2e590b2235cf.
08:40:09.665 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=75e9201a-fec6-4d66-a25c-2e590b2235cf.
08:40:09.666 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=7fb8a7b3-e2c9-4b21-9871-81889534f6f2.
08:40:09.666 | DEBUG   | prefect.events.clients - Added event id=7fb8a7b3-e2c9-4b21-9871-81889534f6f2 to unconfirmed events list. There are now 17 unconfirmed events.
08:40:09.666 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.666 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=7fb8a7b3-e2c9-4b21-9871-81889534f6f2.
08:40:09.667 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-b25' - [FollowUp:b5f697ac] Fetching reminder state from Redis
08:40:09.667 | DEBUG   | Task run 'Build and Publish Follow-up Reminder Message-b25' - [FollowUp:b5f697ac] Payload built: [TextMessage(type='text', quick_reply=None, sender=None, text='報告 [N/A] 還沒好嗎？', emojis=None, quote_token=None)]
08:40:09.667 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=7fb8a7b3-e2c9-4b21-9871-81889534f6f2.
08:40:09.668 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-b25' - [FollowUp:b5f697ac] Follow-up reminder enqueued to line_push_message_queue.
08:40:09.669 | INFO    | Task run 'Build and Publish Follow-up Reminder Message-b25' - Finished in state Completed()
08:40:09.670 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emitting event id=8b484a0a-4d54-43a9-b744-dfeb23236cdc.
08:40:09.670 | INFO    | Flow run 'spirited-pig' - Triggered follow-up flow for reminder b5f697ac-5bec-4e71-a585-5c969d79430a.
08:40:09.670 | DEBUG   | prefect.events.clients - Added event id=8b484a0a-4d54-43a9-b744-dfeb23236cdc to unconfirmed events list. There are now 18 unconfirmed events.
08:40:09.671 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Emit reconnection attempt 0.
08:40:09.671 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Sending event id=8b484a0a-4d54-43a9-b744-dfeb23236cdc.
08:40:09.671 | DEBUG   | prefect.events.clients - EventsClient(id=4553666144): Checkpointing event id=8b484a0a-4d54-43a9-b744-dfeb23236cdc.
08:40:09.700 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:40:09.700 | INFO    | Flow run 'spirited-pig' - Finished in state Completed()
08:40:09.926 | INFO    | prefect.flow_runs.runner - Process for flow run 'spirited-pig' exited cleanly.
08:40:15.600 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103f4e8c0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106d51e10>>)
08:40:15.602 | DEBUG   | prefect.runner - Runner has no active flow runs or deployments. Sending message to loop service that no further cancellation checks are needed.
08:40:15.603 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:40:15.610 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=8570c28b-8a3b-4314-8692-28ff35168e1f.
08:40:15.611 | DEBUG   | prefect.events.clients - Added event id=8570c28b-8a3b-4314-8692-28ff35168e1f to unconfirmed events list. There are now 12 unconfirmed events.
08:40:15.612 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:40:15.612 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=8570c28b-8a3b-4314-8692-28ff35168e1f.
08:40:15.613 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=8570c28b-8a3b-4314-8692-28ff35168e1f.
08:40:17.707 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103f4cc10>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x107003100>>)
08:40:17.708 | DEBUG   | prefect.runner - Runner has no active flow runs or deployments. Sending message to loop service that no further cancellation checks are needed.
08:40:17.709 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:40:17.715 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=36ced321-6cad-425c-90a2-2fc60dd398dc.
08:40:17.716 | DEBUG   | prefect.events.clients - Added event id=36ced321-6cad-425c-90a2-2fc60dd398dc to unconfirmed events list. There are now 13 unconfirmed events.
08:40:17.717 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:40:17.717 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=36ced321-6cad-425c-90a2-2fc60dd398dc.
08:40:17.718 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=36ced321-6cad-425c-90a2-2fc60dd398dc.
08:40:18.177 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:40:18.179 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:40:28.179349+00:00
08:40:18.206 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:40:27.350 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:40:27.352 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:40:37.352250+00:00
08:40:27.380 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:40:30.774 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:40:30.798 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:40:35.191 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:40:35.194 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:40:45.193786+00:00
08:40:35.209 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:40:44.098 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:40:44.103 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:40:54.103614+00:00
08:40:44.130 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:40:56.391 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:40:56.392 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:41:06.392114+00:00
08:40:56.412 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:41:03.565 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:41:03.586 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:41:05.492 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:41:05.493 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:41:15.493505+00:00
08:41:05.512 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:41:13.234 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:41:13.237 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:41:23.236818+00:00
08:41:13.258 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:41:21.774 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:41:21.776 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:41:31.776400+00:00
08:41:21.803 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:41:30.401 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:41:30.403 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:41:40.403448+00:00
08:41:30.426 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:41:40.060 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:41:40.085 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:41:43.035 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:41:43.036 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:41:53.036471+00:00
08:41:43.048 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:41:52.135 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:41:52.137 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:42:02.137286+00:00
08:41:52.159 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:42:04.851 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:42:04.853 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:42:14.853458+00:00
08:42:04.880 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:42:13.341 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:42:13.343 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:42:23.343042+00:00
08:42:13.363 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:42:16.121 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:42:16.147 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:42:22.332 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:42:22.335 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:42:32.335093+00:00
08:42:22.362 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:42:30.781 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:42:30.783 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:42:40.782872+00:00
08:42:30.812 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:42:38.387 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:42:38.388 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:42:48.388228+00:00
08:42:38.407 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:42:45.170 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:42:45.197 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:42:48.331 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:42:48.332 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:42:58.331963+00:00
08:42:48.343 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:42:56.307 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:42:56.308 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:43:06.308601+00:00
08:42:56.329 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:43:06.596 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:43:06.599 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:43:16.598765+00:00
08:43:06.624 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:43:14.190 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:43:14.192 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:43:24.192234+00:00
08:43:14.220 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:43:18.056 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:43:18.081 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:43:23.091 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:43:23.093 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:43:33.092859+00:00
08:43:23.120 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:43:31.559 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:43:31.561 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:43:41.561477+00:00
08:43:31.586 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:43:41.961 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:43:41.992 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:43:42.337 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:43:42.339 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:43:52.339650+00:00
08:43:42.361 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:43:51.397 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:43:51.399 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:44:01.399057+00:00
08:43:51.422 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:43:59.509 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:43:59.510 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:44:09.510206+00:00
08:43:59.526 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:44:07.427 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:44:07.428 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:44:17.428646+00:00
08:44:07.454 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:44:16.395 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:44:16.396 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:44:26.396628+00:00
08:44:16.414 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:44:19.843 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:44:19.865 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:44:24.843 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:44:24.845 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:44:34.844743+00:00
08:44:24.861 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:44:34.548 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:44:34.550 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:44:44.550375+00:00
08:44:34.574 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:44:43.121 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:44:43.126 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:44:53.125958+00:00
08:44:43.154 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:44:45.510 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:44:45.540 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:44:52.193 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:44:52.195 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:45:02.195224+00:00
08:44:52.225 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 1 scheduled_flow_runs
08:44:52.226 | INFO    | prefect.flow_runs.worker - Worker 'ProcessWorker 853e55ce-760a-4c45-884f-563721ceeb78' submitting flow run 'b8471111-221a-4eec-aa46-d33ccfd101e3'
08:44:52.288 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Ready to submit b8471111-221a-4eec-aa46-d33ccfd101e3: True
08:44:52.308 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=ac8f1444-165f-490b-946f-758b01bdba37.
08:44:52.309 | DEBUG   | prefect.events.clients - Added event id=ac8f1444-165f-490b-946f-758b01bdba37 to unconfirmed events list. There are now 14 unconfirmed events.
08:44:52.309 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:44:52.309 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=ac8f1444-165f-490b-946f-758b01bdba37.
08:44:52.310 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=ac8f1444-165f-490b-946f-758b01bdba37.
08:44:52.325 | INFO    | prefect.flow_runs.runner - Opening process...
08:44:52.337 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103eec0d0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106fc9510>>)
08:44:52.338 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:44:52.343 | INFO    | prefect.flow_runs.worker - Completed submission of flow run 'b8471111-221a-4eec-aa46-d33ccfd101e3'
08:44:56.431 | DEBUG   | prefect.profiles - Using profile 'uat'
08:44:56.964 | DEBUG   | Flow run 'airborne-caiman' - Running 1 deployment pull step(s)
08:44:56.975 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:44:56.994 | INFO    | Flow run 'airborne-caiman' -  > Running set_working_directory step...
08:44:57.001 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:44:57.008 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:44:57.010 | DEBUG   | Flow run 'airborne-caiman' - Changing working directory to '/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/'
08:44:57.010 | DEBUG   | Flow run 'airborne-caiman' - Importing flow code from 'orch/flows/scheduled/send_morning_reminder_flow.py:send_morning_reminder_flow'
08:44:58.683 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:44:58.708 | DEBUG   | prefect.engine - Received wait instruction for 1s: Scheduled time is in the future
08:44:59.753 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:44:59.754 | INFO    | Flow run 'airborne-caiman' - Beginning flow run 'airborne-caiman' for flow 'Scheduled - Morning Wake Up Reminder'
08:44:59.754 | INFO    | Flow run 'airborne-caiman' - View at http://0.0.0.0:4201/runs/flow-run/b8471111-221a-4eec-aa46-d33ccfd101e3
08:44:59.755 | DEBUG   | Flow run 'airborne-caiman' - Executing flow 'Scheduled - Morning Wake Up Reminder' for flow run 'airborne-caiman'...
08:45:00.230 | INFO    | prefect.engine - View at http://0.0.0.0:4201/runs/flow-run/a51f8b23-a7fa-4a45-93c2-a9509fd2f3d4
08:45:00.253 | DEBUG   | prefect.task_runner.threadpool - Starting task runner
08:45:00.254 | INFO    | Flow run 'asparagus-guppy' - Beginning subflow run 'asparagus-guppy' for flow 'Send Reminder Message Flow'
08:45:00.254 | INFO    | Flow run 'asparagus-guppy' - View at http://0.0.0.0:4201/runs/flow-run/a51f8b23-a7fa-4a45-93c2-a9509fd2f3d4
08:45:00.255 | DEBUG   | Flow run 'asparagus-guppy' - Executing flow 'Send Reminder Message Flow' for flow run 'asparagus-guppy'...
08:45:00.255 | INFO    | Flow run 'asparagus-guppy' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Sending to platform='slack', destination='uat_channel'
08:45:00.255 | INFO    | Flow run 'asparagus-guppy' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Resolved mentions: ['U08J619BW3B']
08:45:00.256 | INFO    | Flow run 'asparagus-guppy' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Publishing reminder message task...
08:45:00.320 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Created task run 'Build, Publish Initial Reminder & Record State-5ad' for task 'Build, Publish Initial Reminder & Record State'
08:45:00.321 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Executing task 'Build, Publish Initial Reminder & Record State' for task run 'Build, Publish Initial Reminder & Record State-5ad'...
08:45:00.331 | DEBUG   | prefect.events.clients - Reconnecting websocket connection.
08:45:00.331 | DEBUG   | prefect.events.clients - Opening websocket connection.
08:45:00.333 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Task started: channel='slack', template='SlackReminderTemplate' (RemID: dc36dd79-518e-4d09-a742-2b48a0206648)
08:45:00.333 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Received context keys: ['destination_alias', 'mention_aliases', 'interaction_mode', 'main_text', 'sub_text', 'follow_up_policy', 'mentions', 'recipient', 'reminder_id']
08:45:00.333 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Processed placeholders in 'main_text' (RemID: dc36dd79-518e-4d09-a742-2b48a0206648)
08:45:00.334 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Processed placeholders in 'sub_text' (RemID: dc36dd79-518e-4d09-a742-2b48a0206648)
08:45:00.334 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Processed placeholders in 'follow_up_policy.thread_message_template' (RemID: dc36dd79-518e-4d09-a742-2b48a0206648)
08:45:00.335 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Prepended Slack mentions to main_text (RemID: dc36dd79-518e-4d09-a742-2b48a0206648).
08:45:00.335 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Prepared task message for Slack with 'payload' dictionary (RemID: dc36dd79-518e-4d09-a742-2b48a0206648).
08:45:00.335 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Publishing initial reminder task to list 'slack_message_send_queue' (RemID: dc36dd79-518e-4d09-a742-2b48a0206648).
08:45:00.338 | DEBUG   | prefect.events.clients - Pinging to ensure websocket connected.
08:45:00.339 | DEBUG   | prefect.events.clients - Pong received. Websocket connected.
08:45:00.339 | DEBUG   | prefect.events.clients - Resending 0 unconfirmed events.
08:45:00.339 | DEBUG   | prefect.events.clients - Finished resending unconfirmed events.
08:45:00.339 | DEBUG   | prefect.client - Connecting to API at http://0.0.0.0:4201/api/
08:45:00.340 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Successfully published initial reminder task to 'slack_message_send_queue' (RemID: dc36dd79-518e-4d09-a742-2b48a0206648).
08:45:00.341 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Follow-up policy found. Recording state and scheduling next check (RemID: dc36dd79-518e-4d09-a742-2b48a0206648).
08:45:00.342 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Saved initial state for dc36dd79-518e-4d09-a742-2b48a0206648 to Redis hash 'reminder:state:dc36dd79-518e-4d09-a742-2b48a0206648'.
08:45:00.342 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Adding reminder dc36dd79-518e-4d09-a742-2b48a0206648 to schedule ZSET 'reminder:followup_schedule' with score 1743641110 (2025-04-03T00:45:10.341748+00:00).
08:45:00.343 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Successfully added/updated dc36dd79-518e-4d09-a742-2b48a0206648 in schedule ZSET (ZADD returned 1).
08:45:00.344 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-5ad' - Finished in state Completed()
08:45:00.344 | INFO    | Flow run 'asparagus-guppy' - [REMINDER FLOW] (Run ID: N/A) Target 1/2 Reminder message successfully published.
08:45:00.344 | INFO    | Flow run 'asparagus-guppy' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Sending to platform='line', destination='bacon_dm'
08:45:00.344 | INFO    | Flow run 'asparagus-guppy' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Resolved mentions: ['Uccaf1be8b6335a9827558bfbec6769f1']
08:45:00.345 | INFO    | Flow run 'asparagus-guppy' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Publishing reminder message task...
08:45:00.346 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-e63' - Created task run 'Build, Publish Initial Reminder & Record State-e63' for task 'Build, Publish Initial Reminder & Record State'
08:45:00.346 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-e63' - Executing task 'Build, Publish Initial Reminder & Record State' for task run 'Build, Publish Initial Reminder & Record State-e63'...
08:45:00.357 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-e63' - Task started: channel='line', template='LineReminderTemplate' (RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f)
08:45:00.357 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-e63' - Received context keys: ['destination_alias', 'mention_aliases', 'interaction_mode', 'main_text', 'follow_up_policy', 'mentions', 'recipient', 'sub_text', 'reminder_id']
08:45:00.358 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-e63' - Processed placeholders in 'main_text' (RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f)
08:45:00.358 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-e63' - Processed placeholders in 'sub_text' (RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f)
08:45:00.358 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-e63' - Processed placeholders in 'follow_up_policy.thread_message_template' (RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f)
08:45:00.359 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-e63' - Payload: [FlexMessage(type='flex', quick_reply=None, sender=None, alt_text='Reminder: 早安 ☀️ 請點擊按鈕確認你醒著！', contents=FlexBubble(type='bubble', direction=None, styles=None, header=None, hero=None, body=FlexBox(type='box', layout='vertical', flex=None, contents=[FlexText(type='text', flex=None, text='@User1', size=None, align=None, gravity=None, color=None, weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='早安 ☀️ 請點擊按鈕確認你醒著！', size=None, align=None, gravity=None, color=None, weight='bold', style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='時間: 04/03 08:45', size='xs', align=None, gravity=None, color='#aaaaaa', weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None)], spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), footer=FlexBox(type='box', layout='vertical', flex=0, contents=[FlexButton(type='button', flex=None, color=None, style='primary', action=PostbackAction(type='postback', label='知道了', data='action=acknowledge&reminder_id=b765ec39-8c69-4f84-9c56-ad5d47bf835f', display_text=None, text=None, input_option=None, fill_in_text=None), gravity=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, height='sm', adjust_mode=None, scaling=None)], spacing='sm', margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), size=None, action=None))]
08:45:00.360 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-e63' - Prepared task message for Line with 'payload_pickle' string (RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f).
08:45:00.361 | DEBUG   | Task run 'Build, Publish Initial Reminder & Record State-e63' - Publishing initial reminder task to list 'line_push_message_queue' (RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f).
08:45:00.361 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-e63' - Successfully published initial reminder task to 'line_push_message_queue' (RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f).
08:45:00.361 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-e63' - Follow-up policy found. Recording state and scheduling next check (RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f).
08:45:00.363 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-e63' - Saved initial state for b765ec39-8c69-4f84-9c56-ad5d47bf835f to Redis hash 'reminder:state:b765ec39-8c69-4f84-9c56-ad5d47bf835f'.
08:45:00.363 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emitting event id=42695226-72c4-4bcc-a9ea-f8e75df92070.
08:45:00.364 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-e63' - Adding reminder b765ec39-8c69-4f84-9c56-ad5d47bf835f to schedule ZSET 'reminder:followup_schedule' with score 1743641110 (2025-04-03T00:45:10.362822+00:00).
08:45:00.364 | DEBUG   | prefect.events.clients - Added event id=42695226-72c4-4bcc-a9ea-f8e75df92070 to unconfirmed events list. There are now 1 unconfirmed events.
08:45:00.364 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emit reconnection attempt 0.
08:45:00.364 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Sending event id=42695226-72c4-4bcc-a9ea-f8e75df92070.
08:45:00.364 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-e63' - Successfully added/updated b765ec39-8c69-4f84-9c56-ad5d47bf835f in schedule ZSET (ZADD returned 1).
08:45:00.365 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Checkpointing event id=42695226-72c4-4bcc-a9ea-f8e75df92070.
08:45:00.365 | INFO    | Task run 'Build, Publish Initial Reminder & Record State-e63' - Finished in state Completed()
08:45:00.366 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emitting event id=e99fcca6-373b-43b4-8273-0125cf8c7b78.
08:45:00.366 | INFO    | Flow run 'asparagus-guppy' - [REMINDER FLOW] (Run ID: N/A) Target 2/2 Reminder message successfully published.
08:45:00.367 | DEBUG   | prefect.events.clients - Added event id=e99fcca6-373b-43b4-8273-0125cf8c7b78 to unconfirmed events list. There are now 2 unconfirmed events.
08:45:00.368 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emit reconnection attempt 0.
08:45:00.368 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Sending event id=e99fcca6-373b-43b4-8273-0125cf8c7b78.
08:45:00.368 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Checkpointing event id=e99fcca6-373b-43b4-8273-0125cf8c7b78.
08:45:00.370 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emitting event id=a0ca355f-47c4-46b5-b3e5-bacc7ea7de6e.
08:45:00.370 | DEBUG   | prefect.events.clients - Added event id=a0ca355f-47c4-46b5-b3e5-bacc7ea7de6e to unconfirmed events list. There are now 3 unconfirmed events.
08:45:00.370 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emit reconnection attempt 0.
08:45:00.370 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Sending event id=a0ca355f-47c4-46b5-b3e5-bacc7ea7de6e.
08:45:00.370 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Checkpointing event id=a0ca355f-47c4-46b5-b3e5-bacc7ea7de6e.
08:45:00.371 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emitting event id=e6294f7c-80aa-4f82-a2b6-1c0522f0c3a9.
08:45:00.371 | DEBUG   | prefect.events.clients - Added event id=e6294f7c-80aa-4f82-a2b6-1c0522f0c3a9 to unconfirmed events list. There are now 4 unconfirmed events.
08:45:00.371 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emit reconnection attempt 0.
08:45:00.372 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Sending event id=e6294f7c-80aa-4f82-a2b6-1c0522f0c3a9.
08:45:00.372 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Checkpointing event id=e6294f7c-80aa-4f82-a2b6-1c0522f0c3a9.
08:45:00.373 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emitting event id=0345ef30-68f4-4dea-a8e3-1f320448b4ef.
08:45:00.373 | DEBUG   | prefect.events.clients - Added event id=0345ef30-68f4-4dea-a8e3-1f320448b4ef to unconfirmed events list. There are now 5 unconfirmed events.
08:45:00.373 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emit reconnection attempt 0.
08:45:00.373 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Sending event id=0345ef30-68f4-4dea-a8e3-1f320448b4ef.
08:45:00.373 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Checkpointing event id=0345ef30-68f4-4dea-a8e3-1f320448b4ef.
08:45:00.374 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emitting event id=8a5df69c-29e4-426b-839a-e4a60053ef7b.
08:45:00.374 | DEBUG   | prefect.events.clients - Added event id=8a5df69c-29e4-426b-839a-e4a60053ef7b to unconfirmed events list. There are now 6 unconfirmed events.
08:45:00.374 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Emit reconnection attempt 0.
08:45:00.375 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Sending event id=8a5df69c-29e4-426b-839a-e4a60053ef7b.
08:45:00.375 | DEBUG   | prefect.events.clients - EventsClient(id=4415273760): Checkpointing event id=8a5df69c-29e4-426b-839a-e4a60053ef7b.
08:45:00.397 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:45:00.397 | INFO    | Flow run 'asparagus-guppy' - Finished in state Completed()
08:45:00.419 | DEBUG   | prefect.task_runner.threadpool - Stopping task runner
08:45:00.419 | INFO    | Flow run 'airborne-caiman' - Finished in state Completed()
08:45:00.640 | INFO    | prefect.flow_runs.runner - Process for flow run 'airborne-caiman' exited cleanly.
08:45:04.215 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of functools.partial(<bound method Runner._check_for_cancelled_flow_runs of Runner(name='runner-d1aaba0b-81d6-44c5-a884-a617a73729f6')>, should_stop=<function Runner.execute_flow_run.<locals>.<lambda> at 0x103eec0d0>, on_stop=<bound method CancelScope.cancel of <anyio._backends._asyncio.CancelScope object at 0x106fc9510>>)
08:45:04.216 | DEBUG   | prefect.runner - Runner has no active flow runs or deployments. Sending message to loop service that no further cancellation checks are needed.
08:45:04.216 | DEBUG   | prefect.runner - Checking for cancelled flow runs...
08:45:04.221 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emitting event id=b1474f68-1d78-4022-9032-400d77e178f5.
08:45:04.222 | DEBUG   | prefect.events.clients - Added event id=b1474f68-1d78-4022-9032-400d77e178f5 to unconfirmed events list. There are now 15 unconfirmed events.
08:45:04.223 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Emit reconnection attempt 0.
08:45:04.224 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Sending event id=b1474f68-1d78-4022-9032-400d77e178f5.
08:45:04.225 | DEBUG   | prefect.events.clients - EventsClient(id=4409605424): Checkpointing event id=b1474f68-1d78-4022-9032-400d77e178f5.
08:45:04.239 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:45:04.239 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:45:14.239765+00:00
08:45:04.253 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:45:13.966 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:45:13.984 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:45:13.985 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:45:23.985082+00:00
08:45:14.001 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:45:14.004 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:45:22.766 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:45:22.767 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:45:32.767667+00:00
08:45:22.782 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:45:34.548 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:45:34.550 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:45:44.550694+00:00
08:45:34.576 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:45:40.036 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:45:40.052 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:45:46.612 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:45:46.612 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:45:56.612411+00:00
08:45:46.623 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:45:54.267 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:45:54.270 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:46:04.270325+00:00
08:45:54.292 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:46:03.937 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:46:03.937 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:46:13.937889+00:00
08:46:03.954 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:46:10.496 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:46:10.542 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:46:14.424 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:46:14.425 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:46:24.425229+00:00
08:46:14.444 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:46:25.584 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:46:25.586 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:46:35.585865+00:00
08:46:25.611 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:46:36.886 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:46:36.887 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:46:46.887514+00:00
08:46:36.909 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:46:37.598 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:46:37.614 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:46:48.050 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:46:48.052 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:46:58.051963+00:00
08:46:48.077 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:46:58.886 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:46:58.887 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:47:08.887133+00:00
08:46:58.901 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:47:06.681 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:47:06.682 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:47:16.682757+00:00
08:47:06.714 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:47:14.061 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:47:14.087 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:47:14.281 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:47:14.282 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:47:24.282228+00:00
08:47:14.292 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:47:23.350 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:47:23.350 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:47:33.350612+00:00
08:47:23.376 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:47:31.528 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:47:31.529 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:47:41.529378+00:00
08:47:31.552 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:47:40.405 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:47:40.407 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:47:50.407608+00:00
08:47:40.435 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:47:48.217 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:47:48.217 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:47:58.217713+00:00
08:47:48.236 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:47:51.503 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:47:51.516 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:48:00.148 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:48:00.150 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:48:10.150726+00:00
08:48:00.179 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:48:11.057 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:48:11.059 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:48:21.058875+00:00
08:48:11.088 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:48:20.382 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:48:20.407 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:48:23.154 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:48:23.155 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:48:33.155112+00:00
08:48:23.166 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:48:31.649 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:48:31.651 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:48:41.650952+00:00
08:48:31.663 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:48:41.840 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:48:41.844 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:48:51.843825+00:00
08:48:41.872 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:48:53.119 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:48:53.122 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:49:03.122243+00:00
08:48:53.145 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:48:56.539 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'sync_with_backend'
08:48:56.565 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Worker synchronized with the Prefect API server.
08:49:01.508 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:49:01.510 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:49:11.509908+00:00
08:49:01.529 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
08:49:11.259 | DEBUG   | prefect.utilities.services.critical_service_loop - Starting run of 'get_and_submit_flow_runs'
08:49:11.261 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Querying for flow runs scheduled before 2025-04-03 00:49:21.261303+00:00
08:49:11.288 | DEBUG   | prefect.workers.process.processworker 853e55ce-760a-4c45-884f-563721ceeb78 - Discovered 0 scheduled_flow_runs
