[2025-04-03 08:27:35,035] [INFO] [root] - Root logger configured. Level: INFO. Uvicorn integration attempted (clear handlers).
[2025-04-03 08:27:35,712] [INFO] [__main__] - Consumer Service starting up...
[2025-04-03 08:27:35,712] [INFO] [__main__] - Loading configuration from: config/consumer_config.yaml
[2025-04-03 08:27:35,714] [INFO] [__main__] - Configuration loaded successfully.
[2025-04-03 08:27:35,714] [INFO] [broker.redis_manager] - Creating global RedisManager instance using config: config/redis_config.yaml
[2025-04-03 08:27:35,714] [INFO] [broker.redis_manager] - Loaded Redis configuration from config/redis_config.yaml.
[2025-04-03 08:27:35,714] [INFO] [broker.redis_manager] - Attempting to connect to Redis...
[2025-04-03 08:27:35,715] [INFO] [broker.redis_manager] - Connecting using Redis host/port/db from config.
[2025-04-03 08:27:35,716] [INFO] [broker.redis_manager] - Redis connection successful (Host: localhost, Port: 6379, DB: 0).
[2025-04-03 08:27:35,716] [INFO] [broker.redis_manager] - Global RedisManager instance created successfully.
[2025-04-03 08:27:35,716] [INFO] [__main__] - Redis connection verified.
[2025-04-03 08:27:35,716] [INFO] [__main__] - Initializing and starting configured list consumers...
[2025-04-03 08:27:35,716] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Initialized. Listening Key='slack_message_send_queue', BRPOP Timeout=5s, Settings={'max_send_retries': 3}
[2025-04-03 08:27:35,717] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Slack WebClient initialized for sending.
[2025-04-03 08:27:35,717] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Retry policy: Max Retries=3, Delay=3.0s
[2025-04-03 08:27:35,717] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Starting task processing loop on 'slack_message_send_queue'...
[2025-04-03 08:27:35,717] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Worker thread started (ID: 6154809344).
[2025-04-03 08:27:35,717] [INFO] [__main__] - Successfully started consumer '192.168.1.6-26877-8416415552-slack_message_send_queue' on queue 'slack_message_send_queue'.
[2025-04-03 08:27:35,717] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_update_queue] Initialized. Listening Key='slack_message_update_queue', BRPOP Timeout=5s, Settings={}
[2025-04-03 08:27:35,717] [INFO] [consumer.consumer.slack_updater] - [192.168.1.6-26877-8416415552-slack_message_update_queue] Slack WebClient initialized for updating.
[2025-04-03 08:27:35,717] [INFO] [consumer.consumer.slack_updater] - [192.168.1.6-26877-8416415552-slack_message_update_queue] Retry policy: Max=1, Delay=5.0s
[2025-04-03 08:27:35,717] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_update_queue] Starting task processing loop on 'slack_message_update_queue'...
[2025-04-03 08:27:35,717] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_update_queue] Worker thread started (ID: 6171635712).
[2025-04-03 08:27:35,717] [INFO] [__main__] - Successfully started consumer '192.168.1.6-26877-8416415552-slack_message_update_queue' on queue 'slack_message_update_queue'.
[2025-04-03 08:27:35,717] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Initialized. Listening Key='line_push_message_queue', BRPOP Timeout=5s, Settings={}
[2025-04-03 08:27:35,717] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Line MessagingApi client initialized.
[2025-04-03 08:27:35,717] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Retry policy: Max=2, Delay=3.0s
[2025-04-03 08:27:35,717] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Starting task processing loop on 'line_push_message_queue'...
[2025-04-03 08:27:35,717] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Worker thread started (ID: 6188462080).
[2025-04-03 08:27:35,717] [INFO] [__main__] - Successfully started consumer '192.168.1.6-26877-8416415552-line_push_message_queue' on queue 'line_push_message_queue'.
[2025-04-03 08:27:35,717] [INFO] [__main__] - Started 3/3 consumer(s). Service operational.
[2025-04-03 08:27:35,717] [INFO] [__main__] - Consumer service running. Waiting for shutdown signal (SIGINT/SIGTERM)...
[2025-04-03 08:28:09,444] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Received task from 'slack_message_send_queue'.
[2025-04-03 08:28:09,444] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 sending to Slack C08HZSW5T8U
[2025-04-03 08:28:09,460] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Received task from 'line_push_message_queue'.
[2025-04-03 08:28:09,460] [INFO] [consumer.consumer.line_sender] - Processing Line task for recipient Uccaf1be8b6335a9827558bfbec6769f1. RemID: d1a44283-1c92-44d0-bea4-7ece3da83762.
[2025-04-03 08:28:09,460] [INFO] [consumer.consumer.line_sender] - Using pickle-based Line payload (hex) for RemID: d1a44283-1c92-44d0-bea4-7ece3da83762.
[2025-04-03 08:28:09,461] [INFO] [consumer.consumer.line_sender] - Parsed SDK Objects: [FlexMessage(type='flex', quick_reply=None, sender=None, alt_text='Reminder: 早安 ☀️ 請點擊按鈕確認你醒著！', contents=FlexBubble(type='bubble', direction=None, styles=None, header=None, hero=None, body=FlexBox(type='box', layout='vertical', flex=None, contents=[FlexText(type='text', flex=None, text='@User1', size=None, align=None, gravity=None, color=None, weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='早安 ☀️ 請點擊按鈕確認你醒著！', size=None, align=None, gravity=None, color=None, weight='bold', style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='時間: 04/03 08:28', size='xs', align=None, gravity=None, color='#aaaaaa', weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None)], spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), footer=FlexBox(type='box', layout='vertical', flex=0, contents=[FlexButton(type='button', flex=None, color=None, style='primary', action=PostbackAction(type='postback', label='知道了', data='action=acknowledge&reminder_id=d1a44283-1c92-44d0-bea4-7ece3da83762', display_text=None, text=None, input_option=None, fill_in_text=None), gravity=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, height='sm', adjust_mode=None, scaling=None)], spacing='sm', margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), size=None, action=None))]
[2025-04-03 08:28:09,461] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 sending 1 message object(s) to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762).
[2025-04-03 08:28:09,672] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 SUCCESS sending to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762).
[2025-04-03 08:28:09,890] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 SUCCESS sending to Slack C08HZSW5T8U. ts=1743640089.708529
[2025-04-03 08:30:00,360] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Received task from 'slack_message_send_queue'.
[2025-04-03 08:30:00,360] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 sending to Slack C08HZSW5T8U
[2025-04-03 08:30:00,376] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Received task from 'line_push_message_queue'.
[2025-04-03 08:30:00,376] [INFO] [consumer.consumer.line_sender] - Processing Line task for recipient Uccaf1be8b6335a9827558bfbec6769f1. RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04.
[2025-04-03 08:30:00,376] [INFO] [consumer.consumer.line_sender] - Using pickle-based Line payload (hex) for RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04.
[2025-04-03 08:30:00,376] [INFO] [consumer.consumer.line_sender] - Parsed SDK Objects: [FlexMessage(type='flex', quick_reply=None, sender=None, alt_text='Reminder: 早安 ☀️ 請點擊按鈕確認你醒著！', contents=FlexBubble(type='bubble', direction=None, styles=None, header=None, hero=None, body=FlexBox(type='box', layout='vertical', flex=None, contents=[FlexText(type='text', flex=None, text='@User1', size=None, align=None, gravity=None, color=None, weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='早安 ☀️ 請點擊按鈕確認你醒著！', size=None, align=None, gravity=None, color=None, weight='bold', style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='時間: 04/03 08:30', size='xs', align=None, gravity=None, color='#aaaaaa', weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None)], spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), footer=FlexBox(type='box', layout='vertical', flex=0, contents=[FlexButton(type='button', flex=None, color=None, style='primary', action=PostbackAction(type='postback', label='知道了', data='action=acknowledge&reminder_id=73e5ef18-5ec0-42aa-8fe0-8167e14abb04', display_text=None, text=None, input_option=None, fill_in_text=None), gravity=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, height='sm', adjust_mode=None, scaling=None)], spacing='sm', margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), size=None, action=None))]
[2025-04-03 08:30:00,376] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 sending 1 message object(s) to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04).
[2025-04-03 08:30:00,539] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 SUCCESS sending to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04).
[2025-04-03 08:30:00,735] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 SUCCESS sending to Slack C08HZSW5T8U. ts=1743640200.579189
[2025-04-03 08:30:01,709] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Received task from 'slack_message_send_queue'.
[2025-04-03 08:30:01,709] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 sending to Slack C08HZSW5T8U thread 1743640089.708529
[2025-04-03 08:30:01,847] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Received task from 'line_push_message_queue'.
[2025-04-03 08:30:01,847] [INFO] [consumer.consumer.line_sender] - Processing Line task for recipient Uccaf1be8b6335a9827558bfbec6769f1. RemID: d1a44283-1c92-44d0-bea4-7ece3da83762.
[2025-04-03 08:30:01,847] [INFO] [consumer.consumer.line_sender] - Using pickle-based Line payload (hex) for RemID: d1a44283-1c92-44d0-bea4-7ece3da83762.
[2025-04-03 08:30:01,847] [INFO] [consumer.consumer.line_sender] - Parsed SDK Objects: [TextMessage(type='text', quick_reply=None, sender=None, text='報告 [N/A] 還沒好嗎？', emojis=None, quote_token=None)]
[2025-04-03 08:30:01,848] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 sending 1 message object(s) to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762).
[2025-04-03 08:30:02,026] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 SUCCESS sending to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762).
[2025-04-03 08:30:02,409] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 SUCCESS sending to Slack C08HZSW5T8U thread 1743640089.708529. ts=1743640202.143269
[2025-04-03 08:35:00,704] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Received task from 'slack_message_send_queue'.
[2025-04-03 08:35:00,704] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 sending to Slack C08HZSW5T8U
[2025-04-03 08:35:00,720] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Received task from 'line_push_message_queue'.
[2025-04-03 08:35:00,721] [INFO] [consumer.consumer.line_sender] - Processing Line task for recipient Uccaf1be8b6335a9827558bfbec6769f1. RemID: b5f697ac-5bec-4e71-a585-5c969d79430a.
[2025-04-03 08:35:00,721] [INFO] [consumer.consumer.line_sender] - Using pickle-based Line payload (hex) for RemID: b5f697ac-5bec-4e71-a585-5c969d79430a.
[2025-04-03 08:35:00,721] [INFO] [consumer.consumer.line_sender] - Parsed SDK Objects: [FlexMessage(type='flex', quick_reply=None, sender=None, alt_text='Reminder: 早安 ☀️ 請點擊按鈕確認你醒著！', contents=FlexBubble(type='bubble', direction=None, styles=None, header=None, hero=None, body=FlexBox(type='box', layout='vertical', flex=None, contents=[FlexText(type='text', flex=None, text='@User1', size=None, align=None, gravity=None, color=None, weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='早安 ☀️ 請點擊按鈕確認你醒著！', size=None, align=None, gravity=None, color=None, weight='bold', style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='時間: 04/03 08:35', size='xs', align=None, gravity=None, color='#aaaaaa', weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None)], spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), footer=FlexBox(type='box', layout='vertical', flex=0, contents=[FlexButton(type='button', flex=None, color=None, style='primary', action=PostbackAction(type='postback', label='知道了', data='action=acknowledge&reminder_id=b5f697ac-5bec-4e71-a585-5c969d79430a', display_text=None, text=None, input_option=None, fill_in_text=None), gravity=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, height='sm', adjust_mode=None, scaling=None)], spacing='sm', margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), size=None, action=None))]
[2025-04-03 08:35:00,721] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 sending 1 message object(s) to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a).
[2025-04-03 08:35:01,247] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 SUCCESS sending to Slack C08HZSW5T8U. ts=1743640501.089109
[2025-04-03 08:35:18,777] [ERROR] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 FAILED sending to Line Uccaf1be8b6335a9827558bfbec6769f1 with unexpected error.
Traceback (most recent call last):
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/consumer/consumer/line_sender.py", line 303, in process_task
    api_response = self.messaging_api.push_message(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 40, in wrapper_function
    return vd.call(*args, **kwargs)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 134, in call
    return self.execute(m)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 206, in execute
    return self.raw_function(**d, **var_kwargs)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/api/messaging_api.py", line 6508, in push_message
    return self.push_message_with_http_info(push_message_request, x_line_retry_key, **kwargs)  # noqa: E501
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 40, in wrapper_function
    return vd.call(*args, **kwargs)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 134, in call
    return self.execute(m)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 206, in execute
    return self.raw_function(**d, **var_kwargs)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/api/messaging_api.py", line 6621, in push_message_with_http_info
    return self.api_client.call_api(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/api_client.py", line 407, in call_api
    return self.__call_api(resource_path, method,
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/api_client.py", line 212, in __call_api
    response_data = self.request(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/api_client.py", line 451, in request
    return self.rest_client.post_request(url,
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/rest.py", line 270, in post_request
    return self.request("POST", url,
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/rest.py", line 156, in request
    r = self.pool_manager.request(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
[2025-04-03 08:35:18,855] [ERROR] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Unexpected error during process_task.
Traceback (most recent call last):
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/consumer/consumer/line_sender.py", line 303, in process_task
    api_response = self.messaging_api.push_message(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 40, in wrapper_function
    return vd.call(*args, **kwargs)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 134, in call
    return self.execute(m)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 206, in execute
    return self.raw_function(**d, **var_kwargs)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/api/messaging_api.py", line 6508, in push_message
    return self.push_message_with_http_info(push_message_request, x_line_retry_key, **kwargs)  # noqa: E501
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 40, in wrapper_function
    return vd.call(*args, **kwargs)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 134, in call
    return self.execute(m)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/pydantic/v1/decorator.py", line 206, in execute
    return self.raw_function(**d, **var_kwargs)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/api/messaging_api.py", line 6621, in push_message_with_http_info
    return self.api_client.call_api(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/api_client.py", line 407, in call_api
    return self.__call_api(resource_path, method,
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/api_client.py", line 212, in __call_api
    response_data = self.request(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/api_client.py", line 451, in request
    return self.rest_client.post_request(url,
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/rest.py", line 270, in post_request
    return self.request("POST", url,
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/linebot/v3/messaging/rest.py", line 156, in request
    r = self.pool_manager.request(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/bacon.huang85/Library/Caches/pypoetry/virtualenvs/redis-streams-4dGDX2A3-py3.10/lib/python3.10/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/Users/bacon.huang85/.pyenv/versions/3.10.12/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/consumer/base/consumer.py", line 204, in run
    is_task_handled = self.process_task(task_data_str)
  File "/Users/bacon.huang85/Desktop/TPP/chips-fries/redis-streams/src/consumer/consumer/line_sender.py", line 370, in process_task
    raise UnrecoverableError(
consumer.base.exceptions.UnrecoverableError: Unexpected sending error: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
[2025-04-03 08:40:04,829] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Received task from 'slack_message_send_queue'.
[2025-04-03 08:40:04,830] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 sending to Slack C08HZSW5T8U thread 1743640202.143269
[2025-04-03 08:40:05,334] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 SUCCESS sending to Slack C08HZSW5T8U thread 1743640202.143269. ts=1743640805.079559
[2025-04-03 08:40:07,170] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Received task from 'slack_message_send_queue'.
[2025-04-03 08:40:07,170] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 sending to Slack C08HZSW5T8U
[2025-04-03 08:40:07,187] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Received task from 'line_push_message_queue'.
[2025-04-03 08:40:07,187] [INFO] [consumer.consumer.line_sender] - Processing Line task for recipient Uccaf1be8b6335a9827558bfbec6769f1. RemID: 93e2610b-8714-443d-8461-abd2fdb3d056.
[2025-04-03 08:40:07,187] [INFO] [consumer.consumer.line_sender] - Using pickle-based Line payload (hex) for RemID: 93e2610b-8714-443d-8461-abd2fdb3d056.
[2025-04-03 08:40:07,187] [INFO] [consumer.consumer.line_sender] - Parsed SDK Objects: [FlexMessage(type='flex', quick_reply=None, sender=None, alt_text='Reminder: 早安 ☀️ 請點擊按鈕確認你醒著！', contents=FlexBubble(type='bubble', direction=None, styles=None, header=None, hero=None, body=FlexBox(type='box', layout='vertical', flex=None, contents=[FlexText(type='text', flex=None, text='@User1', size=None, align=None, gravity=None, color=None, weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='早安 ☀️ 請點擊按鈕確認你醒著！', size=None, align=None, gravity=None, color=None, weight='bold', style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='時間: 04/03 08:40', size='xs', align=None, gravity=None, color='#aaaaaa', weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None)], spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), footer=FlexBox(type='box', layout='vertical', flex=0, contents=[FlexButton(type='button', flex=None, color=None, style='primary', action=PostbackAction(type='postback', label='知道了', data='action=acknowledge&reminder_id=93e2610b-8714-443d-8461-abd2fdb3d056', display_text=None, text=None, input_option=None, fill_in_text=None), gravity=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, height='sm', adjust_mode=None, scaling=None)], spacing='sm', margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), size=None, action=None))]
[2025-04-03 08:40:07,187] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 sending 1 message object(s) to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: 93e2610b-8714-443d-8461-abd2fdb3d056).
[2025-04-03 08:40:07,415] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 SUCCESS sending to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: 93e2610b-8714-443d-8461-abd2fdb3d056).
[2025-04-03 08:40:07,415] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Received task from 'line_push_message_queue'.
[2025-04-03 08:40:07,415] [INFO] [consumer.consumer.line_sender] - Processing Line task for recipient Uccaf1be8b6335a9827558bfbec6769f1. RemID: d1a44283-1c92-44d0-bea4-7ece3da83762.
[2025-04-03 08:40:07,415] [INFO] [consumer.consumer.line_sender] - Using pickle-based Line payload (hex) for RemID: d1a44283-1c92-44d0-bea4-7ece3da83762.
[2025-04-03 08:40:07,415] [INFO] [consumer.consumer.line_sender] - Parsed SDK Objects: [TextMessage(type='text', quick_reply=None, sender=None, text='報告 [N/A] 還沒好嗎？', emojis=None, quote_token=None)]
[2025-04-03 08:40:07,415] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 sending 1 message object(s) to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762).
[2025-04-03 08:40:07,530] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 SUCCESS sending to Slack C08HZSW5T8U. ts=1743640807.380429
[2025-04-03 08:40:07,569] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 SUCCESS sending to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: d1a44283-1c92-44d0-bea4-7ece3da83762).
[2025-04-03 08:40:09,300] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Received task from 'slack_message_send_queue'.
[2025-04-03 08:40:09,300] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 sending to Slack C08HZSW5T8U thread 1743640200.579189
[2025-04-03 08:40:09,427] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Received task from 'line_push_message_queue'.
[2025-04-03 08:40:09,427] [INFO] [consumer.consumer.line_sender] - Processing Line task for recipient Uccaf1be8b6335a9827558bfbec6769f1. RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04.
[2025-04-03 08:40:09,427] [INFO] [consumer.consumer.line_sender] - Using pickle-based Line payload (hex) for RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04.
[2025-04-03 08:40:09,427] [INFO] [consumer.consumer.line_sender] - Parsed SDK Objects: [TextMessage(type='text', quick_reply=None, sender=None, text='報告 [N/A] 還沒好嗎？', emojis=None, quote_token=None)]
[2025-04-03 08:40:09,427] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 sending 1 message object(s) to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04).
[2025-04-03 08:40:09,618] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 SUCCESS sending to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: 73e5ef18-5ec0-42aa-8fe0-8167e14abb04).
[2025-04-03 08:40:09,668] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Received task from 'line_push_message_queue'.
[2025-04-03 08:40:09,668] [INFO] [consumer.consumer.line_sender] - Processing Line task for recipient Uccaf1be8b6335a9827558bfbec6769f1. RemID: b5f697ac-5bec-4e71-a585-5c969d79430a.
[2025-04-03 08:40:09,668] [INFO] [consumer.consumer.line_sender] - Using pickle-based Line payload (hex) for RemID: b5f697ac-5bec-4e71-a585-5c969d79430a.
[2025-04-03 08:40:09,668] [INFO] [consumer.consumer.line_sender] - Parsed SDK Objects: [TextMessage(type='text', quick_reply=None, sender=None, text='報告 [N/A] 還沒好嗎？', emojis=None, quote_token=None)]
[2025-04-03 08:40:09,668] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 sending 1 message object(s) to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a).
[2025-04-03 08:40:09,685] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 SUCCESS sending to Slack C08HZSW5T8U thread 1743640200.579189. ts=1743640809.507289
[2025-04-03 08:40:09,685] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Received task from 'slack_message_send_queue'.
[2025-04-03 08:40:09,685] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 sending to Slack C08HZSW5T8U thread 1743640501.089109
[2025-04-03 08:40:09,810] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 SUCCESS sending to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: b5f697ac-5bec-4e71-a585-5c969d79430a).
[2025-04-03 08:40:10,076] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 SUCCESS sending to Slack C08HZSW5T8U thread 1743640501.089109. ts=1743640809.897529
[2025-04-03 08:45:00,341] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Received task from 'slack_message_send_queue'.
[2025-04-03 08:45:00,342] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 sending to Slack C08HZSW5T8U
[2025-04-03 08:45:00,361] [INFO] [consumer.base.consumer] - [192.168.1.6-26877-8416415552-line_push_message_queue] Received task from 'line_push_message_queue'.
[2025-04-03 08:45:00,361] [INFO] [consumer.consumer.line_sender] - Processing Line task for recipient Uccaf1be8b6335a9827558bfbec6769f1. RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f.
[2025-04-03 08:45:00,361] [INFO] [consumer.consumer.line_sender] - Using pickle-based Line payload (hex) for RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f.
[2025-04-03 08:45:00,362] [INFO] [consumer.consumer.line_sender] - Parsed SDK Objects: [FlexMessage(type='flex', quick_reply=None, sender=None, alt_text='Reminder: 早安 ☀️ 請點擊按鈕確認你醒著！', contents=FlexBubble(type='bubble', direction=None, styles=None, header=None, hero=None, body=FlexBox(type='box', layout='vertical', flex=None, contents=[FlexText(type='text', flex=None, text='@User1', size=None, align=None, gravity=None, color=None, weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='早安 ☀️ 請點擊按鈕確認你醒著！', size=None, align=None, gravity=None, color=None, weight='bold', style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None), FlexText(type='text', flex=None, text='時間: 04/03 08:45', size='xs', align=None, gravity=None, color='#aaaaaa', weight=None, style=None, decoration=None, wrap=True, line_spacing=None, margin='md', position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, action=None, max_lines=None, contents=None, adjust_mode=None, scaling=None)], spacing=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), footer=FlexBox(type='box', layout='vertical', flex=0, contents=[FlexButton(type='button', flex=None, color=None, style='primary', action=PostbackAction(type='postback', label='知道了', data='action=acknowledge&reminder_id=b765ec39-8c69-4f84-9c56-ad5d47bf835f', display_text=None, text=None, input_option=None, fill_in_text=None), gravity=None, margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, height='sm', adjust_mode=None, scaling=None)], spacing='sm', margin=None, position=None, offset_top=None, offset_bottom=None, offset_start=None, offset_end=None, background_color=None, border_color=None, border_width=None, corner_radius=None, width=None, max_width=None, height=None, max_height=None, padding_all=None, padding_top=None, padding_bottom=None, padding_start=None, padding_end=None, action=None, justify_content=None, align_items=None, background=None), size=None, action=None))]
[2025-04-03 08:45:00,362] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 sending 1 message object(s) to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f).
[2025-04-03 08:45:00,595] [INFO] [consumer.consumer.line_sender] - [192.168.1.6-26877-8416415552-line_push_message_queue] Attempt 1/3 SUCCESS sending to Line Uccaf1be8b6335a9827558bfbec6769f1 (RemID: b765ec39-8c69-4f84-9c56-ad5d47bf835f).
[2025-04-03 08:45:00,746] [INFO] [consumer.consumer.slack_sender] - [192.168.1.6-26877-8416415552-slack_message_send_queue] Attempt 1/4 SUCCESS sending to Slack C08HZSW5T8U. ts=1743641100.591239
